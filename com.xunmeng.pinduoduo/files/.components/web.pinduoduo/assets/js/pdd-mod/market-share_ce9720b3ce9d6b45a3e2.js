(window.webpackJsonpForReact=window.webpackJsonpForReact||[]).push([[4],{"+qE3":function(e,t,r){"use strict";var n,a="object"==typeof Reflect?Reflect:null,i=a&&"function"==typeof a.apply?a.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};n=a&&"function"==typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var h=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var a,i,o;if(u(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),void 0===o)o=i[t]=r,++e._eventsCount;else if("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(a=c(e))>0&&o.length>a&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,function(e){console&&console.warn&&console.warn(e)}(s)}return e}function _(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(n);return a.listener=r,n.wrapFn=a,a}function E(e,t,r){var n=e._events;if(void 0===n)return[];var a=n[t];return void 0===a?[]:"function"==typeof a?r?[a.listener||a]:[a]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(a):S(a,a.length)}function f(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function S(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return h},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");h=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,a=this._events;if(void 0!==a)n=n&&void 0===a.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var h=a[e];if(void 0===h)return!1;if("function"==typeof h)i(h,this,t);else{var u=h.length,c=S(h,u);for(r=0;r<u;++r)i(c[r],this,t)}return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return u(t),this.on(e,_(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,_(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,a,i,o;if(u(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,a=i;break}if(a<0)return this;0===a?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,a),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var a,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(a=i[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return E(this,e,!0)},s.prototype.rawListeners=function(e){return E(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},s.prototype.listenerCount=f,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},"49sm":function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},"8wto":function(e,t,r){"use strict";(function(e){function n(e){return e.replace(/[^A-Za-z0-9+/]/g,"")}function a(e){return!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])&&/[^\x00-\x7F]/.test(e)?function(e){return window.btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}(e):function(e){return window.btoa(e)}(e)}function i(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?function(e){return window.atob(n(e))}(e):function(e){return decodeURIComponent(window.atob(n(e)).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}(e)}r.d(t,"b",function(){return a}),r.d(t,"a",function(){return i})}).call(this,r("tjlA").Buffer)},ANhw:function(e,t){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var r=[],n=0;n<e.length;n+=3)for(var a=e[n]<<16|e[n+1]<<8|e[n+2],i=0;i<4;i++)8*n+6*i<=8*e.length?r.push(t.charAt(a>>>6*(3-i)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var r=[],n=0,a=0;n<e.length;a=++n%4)0!=a&&r.push((t.indexOf(e.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<2*a|t.indexOf(e.charAt(n))>>>6-2*a);return r}};e.exports=r}()},H7XF:function(e,t,r){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,n=u(e),o=n[0],s=n[1],h=new i(function(e,t,r){return 3*(t+r)/4-r}(0,o,s)),c=0,l=s>0?o-4:o;for(r=0;r<l;r+=4)t=a[e.charCodeAt(r)]<<18|a[e.charCodeAt(r+1)]<<12|a[e.charCodeAt(r+2)]<<6|a[e.charCodeAt(r+3)],h[c++]=t>>16&255,h[c++]=t>>8&255,h[c++]=255&t;2===s&&(t=a[e.charCodeAt(r)]<<2|a[e.charCodeAt(r+1)]>>4,h[c++]=255&t);1===s&&(t=a[e.charCodeAt(r)]<<10|a[e.charCodeAt(r+1)]<<4|a[e.charCodeAt(r+2)]>>2,h[c++]=t>>8&255,h[c++]=255&t);return h},t.fromByteArray=function(e){for(var t,r=e.length,a=r%3,i=[],o=0,s=r-a;o<s;o+=16383)i.push(l(e,o,o+16383>s?s:o+16383));1===a?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===a&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],a=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,h=o.length;s<h;++s)n[s]=o[s],a[o.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function l(e,t,r){for(var n,a=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),a.push(c(n));return a.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},aCH8:function(e,t,r){!function(){var t=r("ANhw"),n=r("mmNF").utf8,a=r("g0l/"),i=r("mmNF").bin,o=function(e,r){e.constructor==String?e=r&&"binary"===r.encoding?i.stringToBytes(e):n.stringToBytes(e):a(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var s=t.bytesToWords(e),h=8*e.length,u=1732584193,c=-271733879,l=-1732584194,_=271733878,E=0;E<s.length;E++)s[E]=16711935&(s[E]<<8|s[E]>>>24)|4278255360&(s[E]<<24|s[E]>>>8);s[h>>>5]|=128<<h%32,s[14+(h+64>>>9<<4)]=h;var f=o._ff,S=o._gg,p=o._hh,T=o._ii;for(E=0;E<s.length;E+=16){var A=u,I=c,d=l,v=_;c=T(c=T(c=T(c=T(c=p(c=p(c=p(c=p(c=S(c=S(c=S(c=S(c=f(c=f(c=f(c=f(c,l=f(l,_=f(_,u=f(u,c,l,_,s[E+0],7,-680876936),c,l,s[E+1],12,-389564586),u,c,s[E+2],17,606105819),_,u,s[E+3],22,-1044525330),l=f(l,_=f(_,u=f(u,c,l,_,s[E+4],7,-176418897),c,l,s[E+5],12,1200080426),u,c,s[E+6],17,-1473231341),_,u,s[E+7],22,-45705983),l=f(l,_=f(_,u=f(u,c,l,_,s[E+8],7,1770035416),c,l,s[E+9],12,-1958414417),u,c,s[E+10],17,-42063),_,u,s[E+11],22,-1990404162),l=f(l,_=f(_,u=f(u,c,l,_,s[E+12],7,1804603682),c,l,s[E+13],12,-40341101),u,c,s[E+14],17,-1502002290),_,u,s[E+15],22,1236535329),l=S(l,_=S(_,u=S(u,c,l,_,s[E+1],5,-165796510),c,l,s[E+6],9,-1069501632),u,c,s[E+11],14,643717713),_,u,s[E+0],20,-373897302),l=S(l,_=S(_,u=S(u,c,l,_,s[E+5],5,-701558691),c,l,s[E+10],9,38016083),u,c,s[E+15],14,-660478335),_,u,s[E+4],20,-405537848),l=S(l,_=S(_,u=S(u,c,l,_,s[E+9],5,568446438),c,l,s[E+14],9,-1019803690),u,c,s[E+3],14,-187363961),_,u,s[E+8],20,1163531501),l=S(l,_=S(_,u=S(u,c,l,_,s[E+13],5,-1444681467),c,l,s[E+2],9,-51403784),u,c,s[E+7],14,1735328473),_,u,s[E+12],20,-1926607734),l=p(l,_=p(_,u=p(u,c,l,_,s[E+5],4,-378558),c,l,s[E+8],11,-2022574463),u,c,s[E+11],16,1839030562),_,u,s[E+14],23,-35309556),l=p(l,_=p(_,u=p(u,c,l,_,s[E+1],4,-1530992060),c,l,s[E+4],11,1272893353),u,c,s[E+7],16,-155497632),_,u,s[E+10],23,-1094730640),l=p(l,_=p(_,u=p(u,c,l,_,s[E+13],4,681279174),c,l,s[E+0],11,-358537222),u,c,s[E+3],16,-722521979),_,u,s[E+6],23,76029189),l=p(l,_=p(_,u=p(u,c,l,_,s[E+9],4,-640364487),c,l,s[E+12],11,-421815835),u,c,s[E+15],16,530742520),_,u,s[E+2],23,-995338651),l=T(l,_=T(_,u=T(u,c,l,_,s[E+0],6,-198630844),c,l,s[E+7],10,1126891415),u,c,s[E+14],15,-1416354905),_,u,s[E+5],21,-57434055),l=T(l,_=T(_,u=T(u,c,l,_,s[E+12],6,1700485571),c,l,s[E+3],10,-1894986606),u,c,s[E+10],15,-1051523),_,u,s[E+1],21,-2054922799),l=T(l,_=T(_,u=T(u,c,l,_,s[E+8],6,1873313359),c,l,s[E+15],10,-30611744),u,c,s[E+6],15,-1560198380),_,u,s[E+13],21,1309151649),l=T(l,_=T(_,u=T(u,c,l,_,s[E+4],6,-145523070),c,l,s[E+11],10,-1120210379),u,c,s[E+2],15,718787259),_,u,s[E+9],21,-343485551),u=u+A>>>0,c=c+I>>>0,l=l+d>>>0,_=_+v>>>0}return t.endian([u,c,l,_])};o._ff=function(e,t,r,n,a,i,o){var s=e+(t&r|~t&n)+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._gg=function(e,t,r,n,a,i,o){var s=e+(t&n|r&~n)+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._hh=function(e,t,r,n,a,i,o){var s=e+(t^r^n)+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._ii=function(e,t,r,n,a,i,o){var s=e+(r^(t|~n))+(a>>>0)+o;return(s<<i|s>>>32-i)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,r){if(void 0===e||null===e)throw new Error("Illegal argument "+e);var n=t.wordsToBytes(o(e,r));return r&&r.asBytes?n:r&&r.asString?i.bytesToString(n):t.bytesToHex(n)}}()},"g0l/":function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},"kVK+":function(e,t){t.read=function(e,t,r,n,a){var i,o,s=8*a-n-1,h=(1<<s)-1,u=h>>1,c=-7,l=r?a-1:0,_=r?-1:1,E=e[t+l];for(l+=_,i=E&(1<<-c)-1,E>>=-c,c+=s;c>0;i=256*i+e[t+l],l+=_,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=n;c>0;o=256*o+e[t+l],l+=_,c-=8);if(0===i)i=1-u;else{if(i===h)return o?NaN:1/0*(E?-1:1);o+=Math.pow(2,n),i-=u}return(E?-1:1)*o*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var o,s,h,u=8*i-a-1,c=(1<<u)-1,l=c>>1,_=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,E=n?0:i-1,f=n?1:-1,S=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-o))<1&&(o--,h*=2),(t+=o+l>=1?_/h:_*Math.pow(2,1-l))*h>=2&&(o++,h/=2),o+l>=c?(s=0,o=c):o+l>=1?(s=(t*h-1)*Math.pow(2,a),o+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,a),o=0));a>=8;e[r+E]=255&s,E+=f,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;e[r+E]=255&o,E+=f,o/=256,u-=8);e[r+E-f]|=128*S}},mmNF:function(e,t){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=r},sXyB:function(e,t,r){var n=r("SksO");function a(t,r,i){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?e.exports=a=function(e,t,r){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return r&&n(i,r.prototype),i}:e.exports=a=Reflect.construct,a.apply(null,arguments)}e.exports=a},tjlA:function(e,t,r){"use strict";(function(e){var n=r("H7XF"),a=r("kVK+"),i=r("49sm");function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=h.prototype:(null===e&&(e=new h(t)),e.length=t),e}function h(e,t,r){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return u(this,e,t,r)}function u(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n);h.TYPED_ARRAY_SUPPORT?(e=t).__proto__=h.prototype:e=_(e,t);return e}(e,t,r,n):"string"==typeof t?function(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!h.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(t,r),a=(e=s(e,n)).write(t,r);a!==n&&(e=e.slice(0,a));return e}(e,t,r):function(e,t){if(h.isBuffer(t)){var r=0|E(t.length);return 0===(e=s(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):_(e,t);if("Buffer"===t.type&&i(t.data))return _(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(c(t),e=s(e,t<0?0:0|E(t)),!h.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function _(e,t){var r=t.length<0?0:0|E(t.length);e=s(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function E(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function f(e,t){if(h.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return B(e).length;default:if(n)return j(e).length;t=(""+t).toLowerCase(),n=!0}}function S(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function p(e,t,r,n,a){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(a)return-1;r=e.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof t&&(t=h.from(t,n)),h.isBuffer(t))return 0===t.length?-1:T(e,t,r,n,a);if("number"==typeof t)return t&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):T(e,[t],r,n,a);throw new TypeError("val must be string, number or Buffer")}function T(e,t,r,n,a){var i,o=1,s=e.length,h=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,s/=2,h/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var c=-1;for(i=r;i<s;i++)if(u(e,i)===u(t,-1===c?0:i-c)){if(-1===c&&(c=i),i-c+1===h)return c*o}else-1!==c&&(i-=i-c),c=-1}else for(r+h>s&&(r=s-h),i=r;i>=0;i--){for(var l=!0,_=0;_<h;_++)if(u(e,i+_)!==u(t,_)){l=!1;break}if(l)return i}return-1}function A(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[r+o]=s}return o}function I(e,t,r,n){return G(j(t,e.length-r),e,r,n)}function d(e,t,r,n){return G(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function v(e,t,r,n){return d(e,t,r,n)}function g(e,t,r,n){return G(B(t),e,r,n)}function y(e,t,r,n){return G(function(e,t){for(var r,n,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,a=r%256,i.push(a),i.push(n);return i}(t,e.length-r),e,r,n)}function m(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,o,s,h,u=e[a],c=null,l=u>239?4:u>223?3:u>191?2:1;if(a+l<=r)switch(l){case 1:u<128&&(c=u);break;case 2:128==(192&(i=e[a+1]))&&(h=(31&u)<<6|63&i)>127&&(c=h);break;case 3:i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&(h=(15&u)<<12|(63&i)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&(h=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&h<1114112&&(c=h)}null===c?(c=65533,l=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),a+=l}return function(e){var t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=O));return r}(n)}t.Buffer=h,t.SlowBuffer=function(e){+e!=e&&(e=0);return h.alloc(+e)},t.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),h.poolSize=8192,h._augment=function(e){return e.__proto__=h.prototype,e},h.from=function(e,t,r){return u(null,e,t,r)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(e,t,r){return function(e,t,r,n){return c(t),t<=0?s(e,t):void 0!==r?"string"==typeof n?s(e,t).fill(r,n):s(e,t).fill(r):s(e,t)}(null,e,t,r)},h.allocUnsafe=function(e){return l(null,e)},h.allocUnsafeSlow=function(e){return l(null,e)},h.isBuffer=function(e){return!(null==e||!e._isBuffer)},h.compare=function(e,t){if(!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,a=0,i=Math.min(r,n);a<i;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:n<r?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=h.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){var o=e[r];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,a),a+=o.length}return n},h.byteLength=f,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)S(this,t,t+1);return this},h.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},h.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},h.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):function(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return N(this,t,r);case"base64":return m(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}.apply(this,arguments)},h.prototype.equals=function(e){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===h.compare(this,e)},h.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},h.prototype.compare=function(e,t,r,n,a){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&t>=r)return 0;if(n>=a)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,a>>>=0,this===e)return 0;for(var i=a-n,o=r-t,s=Math.min(i,o),u=this.slice(n,a),c=e.slice(t,r),l=0;l<s;++l)if(u[l]!==c[l]){i=u[l],o=c[l];break}return i<o?-1:o<i?1:0},h.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},h.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},h.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},h.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-t;if((void 0===r||r>a)&&(r=a),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return A(this,e,t,r);case"utf8":case"utf-8":return I(this,e,t,r);case"ascii":return d(this,e,t,r);case"latin1":case"binary":return v(this,e,t,r);case"base64":return g(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var O=4096;function R(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}function N(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}function L(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var a="",i=t;i<r;++i)a+=x(e[i]);return a}function D(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}function b(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,a,i){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function P(e,t,r,n){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-r,2);a<i;++a)e[r+a]=(t&255<<8*(n?a:1-a))>>>8*(n?a:1-a)}function H(e,t,r,n){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-r,4);a<i;++a)e[r+a]=t>>>8*(n?a:3-a)&255}function w(e,t,r,n,a,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,n,i){return i||w(e,0,r,4),a.write(e,t,r,n,23,4),r+4}function k(e,t,r,n,i){return i||w(e,0,r,8),a.write(e,t,r,n,52,8),r+8}h.prototype.slice=function(e,t){var r,n=this.length;if(e=~~e,t=void 0===t?n:~~t,e<0?(e+=n)<0&&(e=0):e>n&&(e=n),t<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),h.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=h.prototype;else{var a=t-e;r=new h(a,void 0);for(var i=0;i<a;++i)r[i]=this[i+e]}return r},h.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||b(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},h.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||b(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n},h.prototype.readUInt8=function(e,t){return t||b(e,1,this.length),this[e]},h.prototype.readUInt16LE=function(e,t){return t||b(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUInt16BE=function(e,t){return t||b(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUInt32LE=function(e,t){return t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUInt32BE=function(e,t){return t||b(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||b(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*t)),n},h.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||b(e,t,this.length);for(var n=t,a=1,i=this[e+--n];n>0&&(a*=256);)i+=this[e+--n]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},h.prototype.readInt8=function(e,t){return t||b(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){t||b(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(e,t){t||b(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(e,t){return t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readFloatLE=function(e,t){return t||b(e,4,this.length),a.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return t||b(e,4,this.length),a.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return t||b(e,8,this.length),a.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return t||b(e,8,this.length),a.read(this,e,!1,52,8)},h.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var a=1,i=0;for(this[t]=255&e;++i<r&&(a*=256);)this[t+i]=e/a&255;return t+r},h.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t|=0,r|=0,n)||M(this,e,t,r,Math.pow(2,8*r)-1,0);var a=r-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+r},h.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,255,0),h.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},h.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},h.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},h.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):H(this,e,t,!0),t+4},h.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):H(this,e,t,!1),t+4},h.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var a=Math.pow(2,8*r-1);M(this,e,t,r,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},h.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var a=Math.pow(2,8*r-1);M(this,e,t,r,a-1,-a)}var i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},h.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,1,127,-128),h.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},h.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},h.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},h.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):H(this,e,t,!0),t+4},h.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),h.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):H(this,e,t,!1),t+4},h.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},h.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},h.prototype.writeDoubleLE=function(e,t,r){return k(this,e,t,!0,r)},h.prototype.writeDoubleBE=function(e,t,r){return k(this,e,t,!1,r)},h.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var a,i=n-r;if(this===e&&r<t&&t<n)for(a=i-1;a>=0;--a)e[a+t]=this[a+r];else if(i<1e3||!h.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},h.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!h.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=h.isBuffer(e)?e:j(new h(e,n).toString()),s=o.length;for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};var W=/[^+\/0-9A-Za-z-_]/g;function x(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var r;t=t||1/0;for(var n=e.length,a=null,i=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!a){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function B(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(W,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);++a)t[a+r]=e[a];return a}}).call(this,r("yLpj"))},zRS3:function(e,t,r){"use strict";r.r(t);var n=r("cDf5"),a=r.n(n),i=r("lwsE"),o=r.n(i),s=r("W8MJ"),h=r.n(s),u=r("mj+i"),c={DEFAULT:0,WECHAT_SESSION:1,WECHAT_TIMELINE:2,WEIBO:3,QQ_CHAT_SESSION:4,QQ_ZONE:5,TENCENT_WEIBO:6,WECHAT_SESSION_APP:7,WECHAT_TIMELINE_IMAGE:8,WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:9,WECHAT_SESSION_IMAGE:10,QQ_CHAT_SESSION_IMAGE:11,QQ_ZONE_IMAGE:12,WEIBO_IMAGE:13,WECHAT_TIMELINE_IMAGES:15,WECHAT_SESSION_TEXT_WITH_NO_SDK:16,WECHAT_SESSION_TEXT:17,IOS_SYSTEM_SHARE_CARD:18,WECHAT_SESSION_IMAGE_WITH_NO_SDK:19,WECHAT_SESSION_IMAGES_WITH_NO_SDK:20,WECHAT_TIMELINE_TEXT:21,SHARE_IMAGE_PASSIVELY:22,COPY_LINK:23,WECHAT_SESSION_MUSIC:24,WECHAT_SESSION_VIDEO:25,EXT_WECHAT_SESSION_CARD_SYSTEM:105,EXT_WECHAT_SESSION_IMAGE_SYSTEM:106,EXT_WECHAT_SESSION_CARD:107,EXT_WECHAT_TIMELINE_CARD:108,EXT_WECHAT_SESSION_IMAGE:109,EXT_WECHAT_TIMELINE_IMAGE:110,STAND_WECHAT_SESSION_CARD:200,STAND_WECHAT_SESSION_IMAGE:201,STAND_WECHAT_TIMELINE_CARD:202,STAND_WECHAT_TIMELINE_IMAGE:203,STAND_WECHAT_SESSION_TEXT:204,STAND_WECHAT_TIMELINE_TEXT:205,WECHAT_SESSION_CARD_WITH_NO_SDK:9996,WECHAT_TIMELINE_CARD_WITH_NO_SDK:9997,FRIENDS:9998,WECHAT_BIG_IMAGE:9999,PIN_TIMELINE:1e4},l={DEFAULT:0,ON_SHARE_TRIGGER:1,ON_SHARE_COMPLETED:2,SDK_INIT_FAILED:3,ON_SHARE_BUTTON_CLICKED:4,ON_SHARE_PREPARE:5,ON_SDK_READY:6,ON_SHARE_INTERRUPT:7,SHARE_LIMIT_LOAD_FAIL:8,PERFORM_LOG_FAILED:9,SHARE_REACH_LIMIT:10},_=r("o0o1"),E=r.n(_),f=r("yXPU"),S=r.n(f),p=r("KoDT"),T=r("a1gu"),A=r.n(T),I=r("Nsbk"),d=r.n(I),v=r("iWIM"),g=r.n(v),y=r("7W2i"),m=r.n(y),C=r("h3qu"),O=r("MpJ2"),R=r("+qE3"),N={DEFAULT:0,SHARE_PARAMS_NOT_VALID:1,SHARE_TYPE_DISABLED:2,SHARE_TYPE_NOT_FOUND:3,SHARE_ACTION_DISABLE:4,SHARE_STATUS_ILLEGAL:5,SHARE_NOT_SUPPORTED:6,SHARE_LIMITER_NOT_INIT:7},L=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.errorCode=t.errorCode||N.DEFAULT,this.message=t.message||""};L.create=function(e){return new L({errorCode:e})},L.ShareErrorCode=N;var D=L,b=r("fkZF"),M=r("8wto"),P=r("J4zp"),H=r.n(P),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";o()(this,e),this.hostname="",this.origin="",this.pagename="",this.pathname="",this.port=0,this.protocol="",this.query={},this.search="",this.hashTag="",this.parseURL(t)}return h()(e,[{key:"parseURL",value:function(e){var t=e.split("#"),r=t[0]||"";this.hashTag=t[1]||"";var n=r.split("?"),a=n[0]||"",i=n[1]||"";this.search="?"+i,this.query=(i.split("&")||[]).reduce(function(e){var t,r,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").split("=");try{t=decodeURIComponent(n[0]||""),r=decodeURIComponent(n[1]||"")}catch(e){t=""}return t&&(e[t]=r),e},{});var o=a.match(/^([a-zA-Z]+:)\/\//)||[];this.protocol=o[1]||"";o[0]&&(a=a.replace(o[0],""));var s=a.match(/^((:?[a-zA-Z0-9](:?[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,6})(:\d+)?\//)||[],h=(s[0]||"").replace(/\//g,"").split(":"),u=H()(h,2),c=u[0],l=u[1];this.hostname=c,this.port=parseInt(l||0,10),s[0]&&(a=a.replace(s[0],"")),this.protocol&&this.hostname&&(this.origin="".concat(this.protocol,"//").concat(this.hostname)),this.pathname="/"+a.replace(/^\//,"");var _=a.match(/\/?(\w+\.html)$/)||[];this.pagename=_[1]||""}}]),e}();function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return 0===window.location.href.indexOf("amcomponent://")&&(r=r||new w(t).origin),t=Object(u.a)(e,Object(u.h)(t||location.href)),r?(r=r.replace(/\/$/g,""),"".concat(r).concat(Object(u.d)(t))):t}var k={DEFAULT:0,REDIRECT:1,SERVER_DOMAIN:2,SERVER_CONTROL:3,SERVER_SHORT_URL:4,RAW:5,SERVER_TINY_DOMAIN:6,SERVER_DOMAIN_BASE64:7,DOMAIN_REPLACE:8,MAGIC_TRACE:9,MAGIC_TRACE_DYNAMIC:10,SERVER_SHORT_URL_WITH_CACHE:11,SERVER_TP_APP:12,SERVER_TP_APP_CARD:13};function W(e){return[k.SERVER_CONTROL,k.SERVER_TINY_DOMAIN,k.SERVER_DOMAIN_BASE64,k.DOMAIN_REPLACE].indexOf(e)>=0}function x(e){return[k.SERVER_SHORT_URL,k.SERVER_SHORT_URL_WITH_CACHE].indexOf(e)>=0}var j=k,B="undefined"!=typeof window;function G(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.match(/^http:?/)?e:Object(p.a)().isNativePlatform||!B?"http://".concat(e):location.protocol?"".concat(location.protocol,"//").concat(e):void 0}var F={DEFAULT:"",COMMAND:"kouling",IMAGE:"image",TEXT:"text",CARD:"card",WXAPP_CARD:"custom_card",COPY_LINK:"text"},Q={DEFAULT:"",SYSTEM:"system",SDK:"sdk",MANUAL:"manual",EXTENSION:"extension",STAND:"stand"},Y=r("uf4C"),K=r("rIj9"),X=r("3OdE"),q={};function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new w(e.shareURL).query||{};return{refer_share_id:t.refer_share_id,refer_share_uid:t.refer_share_uid,refer_share_channel:t.refer_share_channel}}function Z(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/^(?:https?:?)?\/\//,"https://")}"undefined"!=typeof window&&(q=X.a.get(location.host)||{});var z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.miniObjectPath,r=new w(t),n=new w(r.query.target_page||""),a=n.query||{},i=V(e),o=e.shareDomain||q.shareDomain;if(a.specialUrl||a.src)return a.src?a.src=U(i,a.src,o):a.src=Z(e.shareURL),"".concat(r.pathname,"?").concat(Object(u.b)(Object.assign({},r.query,{target_page:"".concat(n.pathname,"?").concat(Object(u.b)(a))})));if(a.jump_url||a.launch_url){if(a.jump_url){var s=new w(a.jump_url);if(!s.hostname){var h=s.query;h.specialUrl&&(h.src?h.src=U(i,h.src,o):h.src=Z(e.shareURL),a.jump_url="".concat(s.pathname,"?").concat(Object(u.b)(h)))}}return a.launch_url&&(a.launch_url=U(i,a.launch_url)),"".concat(r.pathname,"?").concat(Object(u.b)(Object.assign({},r.query,{target_page:"".concat(n.pathname,"?").concat(Object(u.b)(a))})))}return r.hostname||n.hostname||!r.query.target_page?"".concat(r.pathname,"?").concat(Object(u.b)(Object.assign({},r.query,i))):"".concat(r.pathname,"?").concat(Object(u.b)(Object.assign({},r.query,{target_page:"".concat(n.pathname,"?").concat(Object(u.b)(Object.assign(a,i)))})))},J={WEIXIN_TINY_DOMAIN:"weixin",SHORT_LINK:"link"},$="h5",ee="ios",te="android",re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n={};n.url=t.shareURL||"",n.activity=t.marketActivityID||0,n.platform=t.platform||"",n.share_refer=V({shareURL:t.shareURL}),n.page_sn=Object(Y.f)(),t.payloadMixin&&"object"===a()(t.payloadMixin)&&(n=Object.assign(n,t.payloadMixin));var i=t.urlAlias||"url_code",o=n[i];if(o&&"string"==typeof o){var s=new w(o).query||{};Object.assign(s,n.share_refer),n[i]="".concat(o.split("?")[0]||"","?").concat(Object(u.b)(s))}var h="api/flow/audience/activity/domain/weixin";return t.shareDomainType===J.SHORT_LINK?h=t.shortURLApi?t.shortURLApi:t.shortCommandApi?t.shortCommandApi:"api/flow/audience/activity/domain/short_url":t.domainURLApi&&(h=t.domainURLApi),("post"===e.toLowerCase()?r.post(h,n):r.get(h,{params:n})).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.shortCommandApi?{shareText:e.share_text||""}:{domain:e.domain,openAppID:e.open_app_id||"",shortURL:e.short_url||"",shareText:e.share_text||""}},function(){return null})},ne=[c.QQ_CHAT_SESSION,c.QQ_ZONE,c.QQ_CHAT_SESSION_IMAGE,c.QQ_ZONE_IMAGE],ae=function(e){return ne.indexOf(e)>=0},ie=r("lSNA"),oe=r.n(ie),se="api/flow/audience/share/trace",he={CIPHER:"CIPHER_TEXT",LINK:"LINK",DOMAIN:"DOMAIN",NORMAL:"NORMAL",IMAGE:"IMAGE",COPY:"COPY"};function ue(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{title:e.title,message:e.message,thumb_url:e.thumbnailURL,share_url:e.shareURL}}function ce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return x(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(t)===F.COMMAND?he.CIPHER:x(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(t)===F.TEXT?he.LINK:W(e.urlWrapType)&&e.marketActivityID&&e.getShareForm(t)===F.CARD?he.DOMAIN:e.getShareForm(t)===F.IMAGE?he.IMAGE:he.NORMAL}function le(){var e=Object(p.a)();return e.isWeChatMiniProgram?e.WxApp:e.isWeChatPlatform?e.WeChat:e.isQQPlatform?e.QQ:e.isNativePlatform||e.isTinyNativePlatform?"h5":""}function _e(e,t){if(!(t&&t.key&&t.value&&t.trace))return e;var r=new w(e),n=t.key,a=t.value,i=t.trace;return U(Object.assign(oe()({},n,a),r.query),i,r.origin)}var Ee=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];o()(this,e),this._isInited=!1,this._magicTrace=null}return h()(e,[{key:"build",value:function(e){var t=e.magicTrace,r=void 0===t?{}:t;return this._isInited?Promise.resolve():(r.key&&r.value&&r.trace&&(this._magicTrace=r,this._isInited=!0),Promise.resolve())}},{key:"isInited",value:function(){return this._isInited}},{key:"transform",value:function(e){return _e(e,this._magicTrace)}},{key:"transformByShareEntity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n={};return n.origin=t.platform||"",n.share_params=t.shareParams||{},n.page_sn=t.pageSn||Object(Y.f)()+"",n.page_info=t.pageInfo||{page_name:Object(Y.e)(),page_url:location&&location.href},t.payloadMixin&&"object"===a()(t.payloadMixin)&&(n=Object.assign(n,t.payloadMixin)),("post"===e.toLowerCase()?r.post(se,n):r.get(se,{params:n})).then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).magic_trace})}("post",{platform:le(),shareParams:ue(e),payloadMixin:e.payloadMixin}).then(function(t){return _e(e.shareURL,t)})}}]),e}(),fe=null;Ee.getInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fe||(fe=new Ee(e)),fe};var Se=Ee,pe=r("aCH8"),Te=r.n(pe);function Ae(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=U({refer_share_id:null,refer_share_uid:null,refer_share_channel:null},e.shareURL),r=e.payloadMixin||{},n=JSON.stringify(r);return Te()(t+n)}var Ie=r("sXyB"),de=r.n(Ie),ve=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this._cacheMap={},this._cacheLimit=t.cacheLimit||20}return h()(e,[{key:"getResponseByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this._cacheMap[e];return t?t.response:null}},{key:"cacheResponseByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(e&&t&&!((Object.keys(this._cacheMap).length||0)>=this._cacheLimit)){var r=this._cacheMap[e];r?r.response=t:this._cacheMap[e]={response:t,count:1,trigger:!1,complete:!1}}}},{key:"_write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0,n=this._cacheMap[t]||{};n[e]=r,this._cacheMap[t]=n}},{key:"_read",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(this._cacheMap[t]||{})[e]}},{key:"getCountByHash",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._read("count",e)||0}},{key:"increaseCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._write("count",e,this.getCountByHash()+1)}},{key:"getShareID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this._read("share_id",e)}},{key:"setShareID",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._write("share_id",e,t)}}]),e}(),ge=null;function ye(){return ge||(ge=de()(ve,Array.prototype.slice.call(arguments))),ge}var me=function(e){return Object(p.a)().version},Ce=null,Oe=function e(){o()(this,e)};function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],me());return Object(p.a)().platform===C.a.PddIOS&&Object(C.c)(r,e)>=0||Object(p.a)().platform===C.a.PddAndroid&&Object(C.c)(r,t)>=0||Object(p.a)().platform===C.a.PDDTinyAndorid}Oe.NATIVE_SAHRE_ERRORS={USER_REFUSE:60005,USER_CANCEL:60006},Oe.checkShareTypeSupport=function(e){var t=!1;if("number"!=typeof e)return!1;switch(e){case c.WECHAT_SESSION:case c.WECHAT_TIMELINE:case c.WECHAT_SESSION_APP:t=!0;break;case c.WEIBO:t=Oe.checkWeiboShare();break;case c.QQ_CHAT_SESSION:case c.QQ_ZONE:t=Oe.checkQQShare();break;case c.TENCENT_WEIBO:t=!1;break;case c.WECHAT_TIMELINE_IMAGE:case c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:t=Oe.checkWeChatTimelineShareImage();break;case c.WECHAT_SESSION_IMAGE:t=Oe.checkWeChatSessionShareImage();break;case c.QQ_CHAT_SESSION_IMAGE:case c.QQ_ZONE_IMAGE:t=Oe.checkQQShareImage();break;case c.WEIBO_IMAGE:t=Oe.checkWeiboShareImage();break;case c.WECHAT_SESSION_TEXT_WITH_NO_SDK:case c.WECHAT_SESSION_TEXT:t=Oe.checkWeChatSessionShareText();break;case c.WECHAT_SESSION_IMAGE_WITH_NO_SDK:case c.WECHAT_SESSION_IMAGES_WITH_NO_SDK:t=Oe.checkWeChatSessionShareImageNoSdk();break;case c.WECHAT_TIMELINE_TEXT:t=Oe.checkWeChatTimelineShareText();break;case c.IOS_SYSTEM_SHARE_CARD:case c.WECHAT_SESSION_CARD_WITH_NO_SDK:case c.WECHAT_TIMELINE_CARD_WITH_NO_SDK:t=Oe.checkIOSSystemShare();break;case c.SHARE_IMAGE_PASSIVELY:t=Oe.checkSupportSaveImageShare();break;case c.COPY_LINK:t=!0;break;case c.WECHAT_SESSION_MUSIC:case c.WECHAT_SESSION_VIDEO:t=Oe.checkSupportShareMedia();break;case c.FRIENDS:case c.WECHAT_BIG_IMAGE:t=!0;break;case c.EXT_WECHAT_SESSION_CARD:case c.EXT_WECHAT_SESSION_CARD_SYSTEM:case c.EXT_WECHAT_TIMELINE_CARD:case c.EXT_WECHAT_SESSION_IMAGE:case c.EXT_WECHAT_SESSION_IMAGE_SYSTEM:case c.EXT_WECHAT_TIMELINE_IMAGE:t=Oe.checkSupportExtension();break;case c.STAND_WECHAT_SESSION_CARD:case c.STAND_WECHAT_TIMELINE_CARD:case c.STAND_WECHAT_SESSION_IMAGE:case c.STAND_WECHAT_TIMELINE_IMAGE:t=Oe.checkSupportStand();break;case c.STAND_WECHAT_SESSION_TEXT:case c.STAND_WECHAT_TIMELINE_TEXT:t=Oe.checkSupportStandText();break;case c.PIN_TIMELINE:t=Oe.checkSupportPinTimeline()}return t},Oe.checkQQShare=function(){var e=me();return(Object(p.a)().platform!==C.a.PddIOS||0!==Object(C.c)(e,"2.0.8"))&&Re("1.1.0","1.1.0")},Oe.checkWeiboShare=function(){return Re("4.81.0","4.81.0")},Oe.checkWeChatTimelineShareImage=function(){return Re("1.1.2","1.1.2")},Oe.checkWeChatSessionShareImage=function(){return Re("3.30.0","3.30.0")},Oe.checkWeChatSessionShareText=function(){return Re("3.53.0","3.53.0")},Oe.checkQQShareImage=function(){return Re("3.35.0","3.35.0")},Oe.checkWeiboShareImage=function(){return Re("4.81.0","4.81.0")},Oe.checkWeChatSessionShareImageNoSdk=function(){return Re("4.37.0","4.36.0")},Oe.checkWeChatTimelineShareText=function(){return Re("4.39.0","4.39.0")},Oe.checkIOSSystemShare=function(){var e=me();return Object(p.a)().platform===C.a.PddIOS&&Object(C.c)(e,"4.37.0")>=0},Oe.checkSupportSaveImageShare=function(){return Re("4.49.0","4.49.0")},Oe.checkSupportStand=function(){var e=me();return Object(p.a)().platform===C.a.PddAndroid&&Object(C.c)(e,"4.73.0")>=0},Oe.checkSupportStandText=function(){var e=me();return Object(p.a)().platform===C.a.PddAndroid&&Object(C.c)(e,"4.77.0")>=0},Oe.checkSupportExtension=function(){var e=me();return Object(p.a)().platform===C.a.PddIOS&&Object(C.c)(e,"4.73.0")>=0},Oe.checkSupportShareCipher=function(){return Re("4.74.0","4.74.0","4.80.0")},Oe.hasNewShareAPI=function(){var e=me();return Object(p.a)().platform===C.a.PddIOS&&Object(C.c)(e,"2.0.0")>=0},Oe.isEnableShareCheck=function(){return Re("4.51.0","4.51.0")},Oe.isLocalCipherSupport=function(){return Re("4.83.0","4.83.0")},Oe.isTPAppShareSupport=function(){return Re("4.85.0","4.85.0")},Oe.checkSupportShareMedia=function(){return Re("4.86.0","4.86.0")},Oe.checkSupportSilentWakeUp=function(){return Object(p.a)().platform!==C.a.PDDTinyAndorid&&Re("4.88.0","4.88.0")},Oe.checkSupportPinTimeline=function(){return Re("5.6.0","5.6.0")},Oe.getShareModuleName=function(){return"JSShare"},Oe.getVenderAppIds=function(e){return Re("4.49.0","4.49.0")?Array.isArray(e)?Object(O.d)(Oe.getShareModuleName(),"venderAppIds",{channels:e}):Promise.reject({message:"invalid params"}):Promise.reject({message:"not support"})},Oe.DEFAULT_SHARE_ICON_SIZE=22,Oe.DEFAULT_SHARE_ICON="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCCAMAAADUivDaAAAAM1BMVEUAAABmZmZmZmZlZWVmZmZmZmZlZWVlZWVoaGhlZWVkZGRmZmZlZWVlZWVlZWVmZmZmZmauFdI/AAAAEHRSTlMAhnjzbtHHEBrfJrGXRzZXUNTSwgAAAPRJREFUWMPt1+sKgzAMBWC71NbLLuf9n3a6sxFYN2vq/gxyEBSFz9pGaLpdOYucuyPJCUtSbheGHo/0Q6swjXhmnNqEqwCYHwfk2iJcFkEuJyDwyi7c+O6V4HhuViFyBkhwVqJNCFwHEq+1CTaB1UCCFWI0BJiXkxJLZkAso2BVK8FaD509SjB/QcQkWBO2iYA1kuLHn5KRbQKvFL8vhT2jUKOs55j3z0WORcUnvVEj9EF6/8JsIzKAd8K6qE444cTviNNBYhrHqZnQOOGEE0444USdyDYhA1Lsfs1dRqrtwTXVPTjTw5y+6EfMwvCtK6pHu6I7B+8m1re+k3UAAAAASUVORK5CYII=",Oe.getInstance=function(){return Ce||(Ce=new Oe),Ce};var Ne=Oe,Le=r("Fcpp");function De(e){var t=e.errorCode,r=void 0===t?0:t,n=e.message,a=void 0===n?"":n,i=e.options,o=void 0===i?{}:i;return new Promise(function(e){Le.a.trackingRecord({op:"real_error",sub_op:"share_error",url:"",page_url:location.href,error_code:r,error_message:a,params:JSON.stringify(o)},function(){e()})}).catch(function(e){})}var be=D.ShareErrorCode,Me=Ne.getShareModuleName,Pe=function(){function e(){o()(this,e),this._inited=!1,this._queryShareTypePromise=null,this._rules=null,this._enableShareTypes=[],this.appOptional=null,this._rom=0,this._isCipherDowngrade=!1,this._enableSilentMode=!1}return h()(e,[{key:"build",value:function(){var e=this;return this._inited?Promise.resolve():(this._queryShareTypePromise||(this._queryShareTypePromise=this.loadRules(),this._queryShareTypePromise.then(function(t){return e._inited=!0,e._processRules(t),Se.getInstance().build({magicTrace:t.magic_trace})}).catch(function(t){De({errorCode:0,message:"",options:{message:t&&t.message,errorCode:t&&t.errorCode}}),e._inited=!0})),this._queryShareTypePromise)}},{key:"getAppOptional",value:function(){return this.appOptional}},{key:"getRules",value:function(){var e=this;return this.build().then(function(){return e._rules},function(){return Promise.resolve(e._rules)})}},{key:"loadRules",value:function(){return Object(p.a)().isNativePlatform?Object(O.d)(Me(),"queryShareTypes",{page_sn:Object(Y.f)()+"",page_info:{page_name:Object(Y.e)(),page_url:location&&location.href}}):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n={};return n.page_sn=t.pageSn||"",n.page_info=t.pageInfo||{},n.platform="h5","post"===e.toLowerCase()?r.post("api/flow/audience/share/types",n):r.get("api/flow/audience/share/types",{params:n})}("post",{pageSn:Object(Y.f)()+"",pageInfo:{page_name:Object(Y.e)(),page_url:location&&location.href}})}},{key:"_processRules",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.share_types||[];this.appOptional=e.app_optional,this._rom=e.rom,this._enableSilentMode=e.is_weird,e.degrade&&this.setCipherDowngrade(!0);var r=[];return this._rules=t.reduce(function(e,t){var n=t.share_type;return n&&(e[n]=t,r.push(parseInt(n,10))),e},{}),this._innerShareTypes=e.inner_share_types||[],this._innerShareTypes.forEach(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.push(parseInt(e.share_type,10))}),this._enableShareTypes=r,this._rules}},{key:"getRuleByType",value:function(e){return(this._rules||{})[e]}},{key:"checkSync",value:function(e,t){if(!this._rules)return be.SHARE_LIMITER_NOT_INIT;if(this._enableShareTypes.indexOf(e)<0)return be.SHARE_TYPE_DISABLED;var r=t.getShareForm(e),n=(this.getRuleByType(e)||{}).share_methods||[];return[F.COMMAND,F.TEXT].indexOf(r)>=0?x(t.urlWrapType)&&t.marketActivityID&&(t.shortURLApi&&n.indexOf(he.LINK)>=0||t.shortCommandApi&&n.indexOf(he.CIPHER)>=0)?0:n.indexOf(he.NORMAL)>=0?0:be.SHARE_TYPE_DISABLED:[c.WECHAT_SESSION,c.WECHAT_TIMELINE].indexOf(e)>=0?W(t.urlWrapType)&&t.marketActivityID&&n.indexOf(he.DOMAIN)<0?be.SHARE_TYPE_DISABLED:n.indexOf(he.NORMAL)>=0?0:be.SHARE_TYPE_DISABLED:0}},{key:"setCipherDowngrade",value:function(e){this._isCipherDowngrade=e}},{key:"isCipherDowngrade",get:function(){return this._isCipherDowngrade}},{key:"rom",get:function(){return this._rom}},{key:"isSilentMode",get:function(){return this._enableSilentMode}}]),e}(),He=null;function we(){return He||(He=new Pe),He}var Ue=Ne.getShareModuleName,ke=Ne.isLocalCipherSupport,We={QUERY_CODE:0,QUERY_TEXT:1,POP_CIPHER:2},xe={CONSUME:0,CONSUME_TIME_DIVIDE:1,CONSUME_RAW:2,RECYCLE:3,RECYCLE_TIME_DIVIDE:4,RECYCLE_RAW:5};var je={};function Be(e){var t=e.consumeMode,r=e.scene;if("number"!=typeof t||[xe.CONSUME_RAW,xe.RECYCLE_RAW].indexOf(t)>=0)return Promise.resolve();var n=function(e){if(e&&!(e.length<=0)){if([xe.CONSUME_TIME_DIVIDE,xe.RECYCLE_TIME_DIVIDE].indexOf(t)>=0){var r=new Date,n=r.getMinutes(),a=r.getSeconds();return e[Math.floor(e.length*(60*n+a)/3600)]}return e[0]}},a=(je[r]||{}).texts;return a?Promise.resolve(n(a)):function(e){return Object(O.d)(Ue(),"getLocalCipherInfo",{action:We.QUERY_TEXT,page_sn:Object(Y.f)()+"",scene:e}).then(function(){var t=((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).texts||[]).map(function(e){if(e)return e.version&&Object(C.c)(e.version,window.__SHARE_CIPHER_VER__||"1.1.1")>=0?e.text:e.version?void 0:e.text}).filter(function(e){return!!e});return je[e]=je[e]||{},je[e].texts=t,t},function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return De({errorCode:e.errorCode,message:"",options:e.data}),null})}(r).then(n)}function Ge(e){var t=e.consumeMode,r=e.scene;return"number"!=typeof t?Promise.resolve():[xe.CONSUME,xe.CONSUME_TIME_DIVIDE,xe.CONSUME_RAW].indexOf(t)>=0?function(e){return Object(O.d)(Ue(),"getLocalCipherInfo",{action:We.POP_CIPHER,page_sn:Object(Y.f)()+"",scene:e}).then(function(e){return e.cipher},function(e){return De({errorCode:e.errorCode,message:"",options:e.data}),null})}(r):function(e){return Object(O.d)(Ue(),"getLocalCipherInfo",{action:We.QUERY_CODE,page_sn:Object(Y.f)()+"",scene:e}).then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ciphers||[]},function(e){return De({errorCode:e.errorCode,message:"",options:e.data}),null})}(r).then(function(e){if(e&&!(e.length<=0))return e[0]})}function Fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var Qe="api/flow/chron/share/card",Ye={TP_FIRST:0,GENERAL_FIRST:1,GENERAL_ONLY:2},Ke={MAIN:0,GENERAL:1,TP:2};function Xe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ye.TP_FIRST,r=e.filter(function(e){return e&&e.dev_type===Ke.GENERAL}),n=e.filter(function(e){return e&&e.dev_type===Ke.TP});Ne.isTPAppShareSupport()||(r=n=[]);var a=e.filter(function(e){return e&&e.dev_type===Ke.MAIN});return t===Ye.TP_FIRST?n[0]||r[0]||a[0]:t===Ye.GENERAL_FIRST?r[0]||n[0]||a[0]:t===Ye.GENERAL_ONLY?r[0]||a[0]:void 0}function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(r),!0).forEach(function(t){oe()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({scene_id:e.activitySceneSn,long_url:e.shareURL||"",rom:e.rom||0,param:{},page_sn:Object(Y.f)()},V(e));return e.payloadMixin&&"object"===a()(e.payloadMixin)&&(n=Object.assign({},e.payloadMixin.param_map,n)),"string"!=typeof n.param&&(n.param=JSON.stringify(n.param)),r.post(Qe,{param_map:n}).then(function(){return Xe((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).infos||[],t)},function(){return null})}var Ve=["mobile.yangkeduo.com","m.hutaojie.com","panduoduo.yangkeduo.com"];function Ze(e){for(var t=[],r=1;r<arguments.length;++r)t.push(arguments[r]);return e.replace(/{(\d+)}/g,function(e,r){return 0===t[r]?0:t[r]||""})}var ze=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.title=t.title||"",this.message=t.message||"",this.shareURL=t.shareURL||"",this.targetShareURL="",this.realShareURL="",this.shareDomain=t.shareDomain||"",this.thumbnailURL=t.thumbnailURL||"",this.timelineDomain=t.timelineDomain||"",this.timelineAppId=t.timelineAppId||"",this.marketActivityID=t.marketActivityID||0,this.urlWrapType=t.urlWrapType||j.DEFAULT,this.shortURLApi=t.shortURLApi||"",this.domainURLApi=t.domainURLApi||"",this.payloadMixin=t.payloadMixin||null,this.requestUsePost=t.requestUsePost||!1}return h()(e,[{key:"normalize",value:function(){var e=S()(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"setShareURLQueries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.urlWrapType!==j.RAW&&(this.shareID=e.refer_share_id,this.shareURL=U(e,this.shareURL))}},{key:"getShareForm",value:function(e){return F.DEFAULT}},{key:"getShareMethod",value:function(e){return Q.DEFAULT}}]),e}();ze.getWrappedShareURLInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shareURL||"",r=e.urlWrapType;if(r===j.DEFAULT||r===j.RAW)return Promise.resolve({realShareURL:t,targetShareURL:t});if(e.timelineDomain&&e.timelineAppId&&r===j.REDIRECT)return Promise.resolve(ze.getRedirectURLInfo(t,e.timelineDomain,e.timelineAppId));if(e.timelineDomain&&r===j.SERVER_DOMAIN)return Promise.resolve(ze.getEncodedURLInfo(t,e.timelineDomain));if(e.marketActivityID&&function(e){return[k.SERVER_CONTROL,k.SERVER_SHORT_URL,k.SERVER_TINY_DOMAIN,k.SERVER_DOMAIN_BASE64,k.DOMAIN_REPLACE,k.SERVER_SHORT_URL_WITH_CACHE].indexOf(e)>=0}(r)){var n=W(r)?J.WEIXIN_TINY_DOMAIN:J.SHORT_LINK,i=t.replace(/^(\w+:)?\/\//,""),o=Ae(e),s=e.cipherScene,h=e.consumeMode,u=ye(),c=function(){var a=new Promise(function(a,o){re(e.requestUsePost?"post":"get",{shareURL:i,marketActivityID:e.marketActivityID,platform:ze.getShareDomainPlatform(),shareDomainType:n,shortURLApi:e.shortURLApi,shortCommandApi:e.shortCommandApi,domainURLApi:e.domainURLApi,payloadMixin:e.payloadMixin}).then(function(i){if(i){if(n===J.WEIXIN_TINY_DOMAIN){var o=i.domain,s=void 0===o?"":o,h=i.openAppID,u=void 0===h?"":h;return void(r===j.SERVER_DOMAIN_BASE64?a(ze.getEncodedURLInfoWithSuffix(t,s,e.marketActivityID)):r===j.DOMAIN_REPLACE?a(ze.getDomainReplacedURL(t,s)):a(ze.getRedirectURLInfo(t,s,r===j.SERVER_TINY_DOMAIN?"":u)))}if(n===J.SHORT_LINK)return void a({useShortURL:!0,realShareURL:i.shortURL||t,targetShareURL:t,shareText:i.shareText})}a({realShareURL:t,targetShareURL:t})})});return n===J.SHORT_LINK&&a.then(function(e){e&&e.useShortURL&&(u.cacheResponseByHash(o,e),u.setShareID(o,(new w(t).query||{}).refer_share_id))}),a};if(r===j.SERVER_SHORT_URL_WITH_CACHE){var l=u.getResponseByHash(s);return l?(u.increaseCount(s),Promise.resolve(l)):(l=u.getResponseByHash(o))?(u.increaseCount(o),Promise.resolve(l)):s&&we().isCipherDowngrade?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scene,r=e.consumeMode;return Object(p.a)().isNativePlatform&&ke()&&t&&"number"==typeof r?Promise.all([Ge(e),Be(e)]).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=H()(e,2),n=t[0],a=t[1];return n&&[xe.CONSUME_RAW,xe.RECYCLE_RAW].indexOf(r)>=0?n:n&&a?Object.assign({text:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.replace(/%s/g,t)}(a,n.cipher)},n):void 0}):Promise.resolve()}({scene:s,consumeMode:h}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e&&e.share_id){var t={cipher:e.cipher,shareText:e.text,shareID:e.share_id};return u.cacheResponseByHash(s,t),u.setShareID(s,e.shareID),t}return c()},function(e){return c()}):c()}return c()}if(r===j.MAGIC_TRACE){var _=Se.getInstance().transform(t);return Promise.resolve({realShareURL:_,targetShareURL:_})}return r===j.MAGIC_TRACE_DYNAMIC?Se.getInstance().transformByShareEntity(e).then(function(e){return{realShareURL:e,targetShareURL:e}},function(){return{realShareURL:t,targetShareURL:t}}):e.marketActivityID&&e.activitySceneSn&&r===j.SERVER_TP_APP?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n={long_url:e.shareURL||"",activity_code:(e.marketActivityID||0)+"",scene_sn:e.activitySceneSn||"",rom:e.rom||0,params:{}};return e.payloadMixin&&"object"===a()(e.payloadMixin)&&(n=Object.assign(n,e.payloadMixin)),"string"!=typeof n.params&&(n.params=JSON.stringify(n.params)),r.post("api/flow/walrus/inquire/confusion/info",n).then(function(){return Xe((arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).infos||[],t)},function(){return null})}(Object.assign({rom:we().rom},e),e.tpSelectCategory).then(function(e){return{tpInfo:e,tpDowngrade:!e,realShareURL:(e||{}).link_url||t,targetShareURL:t}},function(e){return Promise.resolve({tpDowngrade:!0,realShareURL:t,targetShareURL:t})}):e.activitySceneSn&&r===j.SERVER_TP_APP_CARD?qe(Object.assign({rom:we().rom},e),e.tpSelectCategory).then(function(e){return{tpInfo:e,tpDowngrade:!e,realShareURL:(e||{}).link_url||t,targetShareURL:t}},function(e){return Promise.resolve({tpDowngrade:!0,realShareURL:t,targetShareURL:t})}):Promise.resolve({realShareURL:t,targetShareURL:t})},ze.getRedirectURLInfo=function(e,t,r){var n=new w(e),a=n.pathname+n.search,i="http://".concat(t).concat(a);return r?(i="".concat(i,"&xxx_state=123"),{realShareURL:Ze("https://open.weixin.qq.com/connect/oauth2/authorize?response_type=code&scope=snsapi_base&appid={0}&redirect_uri={1}",r,encodeURIComponent(i)),targetShareURL:i}):{realShareURL:i,targetShareURL:i}},ze.getEncodedURLInfo=function(e,t){var r=Object(b.a)(10),n=new w(e),a=n.pathname+n.search;a=(a=Object(M.b)("".concat(r,"/").concat(a))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,",");var i="http://".concat(t,"/").concat(a);return{targetShareURL:i,realShareURL:i}},ze.getEncodedURLInfoWithSuffix=function(e,t,r){var n=new w(e),a=n.pathname+n.search;a=(a=Object(M.b)(a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,",");var i="http://".concat(t,"/").concat(a,".htm?activity=").concat(r);return{targetShareURL:i,realShareURL:i}},ze.getDomainReplacedURL=function(e,t){var r=U({},e,G(t));return{targetShareURL:r,realShareURL:r}},ze.getShareDomainPlatform=function(){var e=Object(p.a)();return e.platform===C.a.PddAndroid?te:e.platform===C.a.PddIOS?ee:$},ze.getQQShareURL=function(e,t){if(!ae(e))return t;var r=new w(t).hostname;return Ve.indexOf(r)<0&&(t=t.replace("//".concat(r),"//".concat("mobile.yangkeduo.com"))),t};var Je=ze,$e=D.ShareErrorCode,et=function(e){function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return o()(this,t),(e=A()(this,d()(t).call(this,r))).ShareEntityClass=Je,e._hasInited=!1,e.shareEntity=r.shareEntity,e.shareEntityMap=r.shareEntityMap||{},e.disableShareTypes=r.disableShareTypes||[],e}return m()(t,e),h()(t,[{key:"initShare",value:function(){this._hasInited||(this._hasInited=!0,this.setMaxListeners(0),this._setupShareTypes(),this._setupPlatformShareSDK())}},{key:"isInited",value:function(){return this._hasInited}},{key:"share",value:function(e){return $e.SHARE_ACTION_DISABLE}},{key:"setShareCheck",value:function(e){}},{key:"checkShareTypeEnable",value:function(e){return 0}},{key:"_setupShareTypes",value:function(){return!0}},{key:"_setupPlatformShareSDK",value:function(){return Promise.resolve()}},{key:"getShareEntityByShareType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;return e?this.shareEntityMap[e]||(t?null:this.shareEntity):this.shareEntity}},{key:"refreshShare",value:function(e,t){return e?(t?this.shareEntityMap[t]=e:this.shareEntity=e,this._setupPlatformShareSDK()):Promise.resolve()}},{key:"disableShare",value:function(e){var t=this;if(e&&"number"==typeof e)this.disableShareTypes.indexOf(e)<0&&this.disableShareTypes.push(e);else{if("[object Array]"!==Object.prototype.toString.call(e))return;this.disableShareTypes=this.disableShareTypes.concat(e.filter(function(e){return(t.disableShareTypes||[]).indexOf(e)<0}))}!this._setupShareTypes()&&this._adjustMenu()}},{key:"_adjustMenu",value:function(){}},{key:"createShareEntity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=this.ShareEntityClass||Je;if(r)return new n(e);var a={};if(t){var i=this.shareEntityMap[t];a=i?Object.assign({},i,e):Object.assign({},this.shareEntity,e)}else a=Object.assign({},this.shareEntity,e);return new n(a)}},{key:"setupNativeShareButton",value:function(e){return $e.SHARE_NOT_SUPPORTED}}]),t}(R.EventEmitter),tt={COMPLETE:0,SUCCESS:1,FAIL:2,CANCEL:3,ERROR:4},rt="static",nt="dynamic",at=2,it=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.shareImageWidth=t.shareImageWidth||375,this.shareImageHeight=t.shareImageHeight||500,this.maxSize=t.maxSize||1e6,this.imageRatio=t.imageRatio||at,this.items=[]}return h()(e,[{key:"w",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.shareImageWidth?e/this.shareImageWidth:0}},{key:"h",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.shareImageHeight?e/this.shareImageHeight:0}},{key:"paint",value:function(){}},{key:"add",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.source&&this.items.push(e)}},{key:"addElem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.getAttrs&&"function"==typeof e.getAttrs&&this.items.push(e.getAttrs())}},{key:"process",value:function(){return this.paint(),{max_size:this.maxSize,width:this.shareImageWidth*this.imageRatio,height:this.shareImageHeight*this.imageRatio,items:this.items}}},{key:"processAsync",value:function(){return Promise.resolve(this.process())}}]),e}(),ot=function(e){return e?Array.isArray(e)&&e.length>0?e[0]:"object"===a()(e)?e:null:null},st=function(e){return e?Array.isArray(e)&&e.length>0?e.map(function(e,t){return e?"string"==typeof e?{type:rt,data:e}:"object"===a()(e)?e.type?e:{type:nt,options:e}:void 0:null}).filter(function(e){return!!e}):"object"===a()(e)?[{type:nt,options:e}]:[]:[]};function ht(e,t){var r=e.drawImageOptions,n=e.drawImageClass;if(r)return t?Promise.resolve(st(r)):Promise.resolve(ot(r));if("function"==typeof n){var a=new n({shareURL:e.shareURL});return a instanceof it?a.processAsync().catch(function(e){return Promise.resolve({})}):Promise.resolve({})}return Promise.resolve({})}function ut(){return ct.apply(this,arguments)}function ct(){return(ct=S()(E.a.mark(function e(){var t,r,n,a=arguments;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.length>0&&void 0!==a[0]?a[0]:{},"function"==typeof(r=a.length>1?a[1]:void 0).cipherProcessor){e.next=4;break}return e.abrupt("return",t);case 4:return e.prev=4,e.next=7,r.cipherProcessor({cipherText:t.title,cipherCode:t.cipher,shareEntity:r});case 7:"string"==typeof(n=e.sent)&&(t.title=t.desc=n),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}},e,null,[[4,11]])}))).apply(this,arguments)}var lt=function(e){function t(e){var r;return o()(this,t),(r=A()(this,d()(t).call(this,e))).drawImageOptions=e.drawImageOptions,r.redirectURI=e.redirectURI||"",r.miniObjectPath=e.miniObjectPath||"",r.miniObjectID=e.miniObjectID,r.useWxAppShare=e.useWxAppShare||!1,r.forceDowngrade=e.forceDowngrade||!1,r.shortCommandApi=e.shortCommandApi||"",r.excludeShareChoices=e.excludeShareChoices||[],r.thirdPartyOpenType=e.thirdPartyOpenType,r.drawImageClass=e.drawImageClass,r.needSharedAmount=e.needSharedAmount||!1,r.maskTemplateID=e.maskTemplateID,r.maskData=e.maskData,r.cipherScene=e.cipherScene,r.consumeMode=e.consumeMode,r.activitySceneSn=e.activitySceneSn,r.tpSelectCategory=e.tpSelectCategory,r.cipherProcessor=e.cipherProcessor,r.pinTimelineParams=e.pinTimelineParams,r}return m()(t,e),h()(t,[{key:"normalize",value:function(){var e=S()(E.a.mark(function e(t){var r,n,i,o,s,h,u,l,_=this;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object.assign({},this),t!==c.PIN_TIMELINE){e.next=3;break}return e.abrupt("return",r.pinTimelineParams);case 3:n={title:r.title,desc:r.message,thumbnail:r.thumbnailURL,share_url:r.shareURL,share_id:r.shareID},r.payloadMixin&&(i=r.payloadMixin.extra,"object"===a()(i)&&void 0!==i.share_prefer&&(n.share_prefer=i.share_prefer)),r.maskTemplateID&&r.maskData&&(n.mask_template_id=r.maskTemplateID,n.mask_data=r.maskData),o=!1,e.t0=t,e.next=e.t0===c.WECHAT_SESSION?10:e.t0===c.WECHAT_TIMELINE_IMAGE?13:e.t0===c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK?13:e.t0===c.WECHAT_SESSION_IMAGE?13:e.t0===c.QQ_CHAT_SESSION_IMAGE?13:e.t0===c.QQ_ZONE_IMAGE?13:e.t0===c.WEIBO_IMAGE?13:e.t0===c.WECHAT_SESSION_IMAGE_WITH_NO_SDK?13:e.t0===c.EXT_WECHAT_SESSION_IMAGE?13:e.t0===c.EXT_WECHAT_SESSION_IMAGE_SYSTEM?13:e.t0===c.EXT_WECHAT_TIMELINE_IMAGE?13:e.t0===c.STAND_WECHAT_SESSION_IMAGE?13:e.t0===c.STAND_WECHAT_TIMELINE_IMAGE?13:e.t0===c.WECHAT_SESSION_IMAGES_WITH_NO_SDK?18:e.t0===c.SHARE_IMAGE_PASSIVELY?23:e.t0===c.IOS_SYSTEM_SHARE_CARD?29:e.t0===c.WECHAT_SESSION_CARD_WITH_NO_SDK?29:e.t0===c.WECHAT_TIMELINE_CARD_WITH_NO_SDK?29:31;break;case 10:if(r.miniObjectPath&&"string"==typeof r.miniObjectPath)n.mini_object_path=z(r);else if("function"==typeof r.miniObjectPath)try{n.mini_object_path=r.miniObjectPath(r.shareURL)}catch(e){}return r.miniObjectID&&(n.mini_object_id=r.miniObjectID),e.abrupt("break",32);case 13:return o=!0,e.next=16,ht(r);case 16:return n.options=e.sent,e.abrupt("break",32);case 18:return o=!0,e.next=21,ht(r,!0);case 21:return n.multi_image_options=e.sent,e.abrupt("break",32);case 23:return o=!0,e.next=26,ht(r);case 26:return n.options=e.sent,r.thirdPartyOpenType&&(n.open_type=r.thirdPartyOpenType),e.abrupt("break",32);case 29:return n.excluded_types=r.excludeShareChoices,e.abrupt("break",32);case 31:return e.abrupt("break",32);case 32:if(s=this.getShareForm.call(r,t),h=[F.COMMAND,F.TEXT].indexOf(s)>=0,this.targetShareURL=r.shareURL,this.realShareURL=r.shareURL,this.useShortURL=!1,t===c.WECHAT_SESSION&&n.mini_object_path&&(this.realShareURL=n.mini_object_path),ae(t)&&(u=Je.getQQShareURL(t,r.shareURL),n.share_url=u,this.shareURL=u,this.realShareURL=u,this.targetShareURL=u),t===c.WECHAT_SESSION&&n.mini_object_path&&(this.realShareURL=this.targetShareURL=n.mini_object_path),s!==F.CARD&&s!==F.WXAPP_CARD){e.next=44;break}return e.abrupt("return",Je.getWrappedShareURLInfo(r).then(function(e){var t=e.realShareURL,r=e.targetShareURL,a=e.useShortURL,i=e.tpDowngrade,o=e.tpInfo;return _.useShortURL=a,_.realShareURL=t,_.targetShareURL=r,n.share_url=t,o&&(n.title=o.title||n.title,n.desc=o.message||n.desc),n.tpInfo=o,n.tpDowngrade=i,n}));case 44:if(!o||!x(r.urlWrapType)&&r.urlWrapType!==j.MAGIC_TRACE&&r.urlWrapType!==j.MAGIC_TRACE_DYNAMIC){e.next=48;break}return e.abrupt("return",Je.getWrappedShareURLInfo(r).then(function(e){var t=e.realShareURL,a=e.targetShareURL,i=e.useShortURL,o=e.shareText;return _.targetShareURL=a,r.shortCommandApi?(_.pcode=o,n.share_url=o):(_.useShortURL=i,_.realShareURL=t,n.share_url=i?G(t):t),n}));case 48:if(!h){e.next=59;break}if(l=n.title||"",!x(r.urlWrapType)){e.next=54;break}return e.abrupt("return",Je.getWrappedShareURLInfo(r).then(function(e){var t=e.realShareURL,a=e.targetShareURL,i=e.useShortURL,o=e.shareText,s=e.shareID,h=e.cipher;if(s&&(n.shareID=s),h&&(n.cipher=h),_.targetShareURL=a,r.shortCommandApi){var u=i||h?o:"";l=Ze(l,u||a,a,u),n.title=n.desc=l,_.pcode=l}else{var c=i?t:"",E=c||a;l=Ze(l,E,a,c),n.title=n.desc=l,_.useShortURL=i,_.realShareURL=E}return ut(n,r)}));case 54:return l=Ze(l,r.shareURL),n.title=n.desc=l,e.abrupt("return",ut(n,r));case 57:e.next=60;break;case 59:return e.abrupt("return",Promise.resolve(n));case 60:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getShareForm",value:function(e){switch(e){case c.WECHAT_SESSION:return this.miniObjectPath||this.useWxAppShare?F.WXAPP_CARD:F.CARD;case c.QQ_CHAT_SESSION:case c.WECHAT_TIMELINE:case c.QQ_ZONE:case c.TENCENT_WEIBO:case c.WECHAT_SESSION_CARD_WITH_NO_SDK:case c.WECHAT_TIMELINE_CARD_WITH_NO_SDK:case c.WECHAT_SESSION_MUSIC:case c.WECHAT_SESSION_VIDEO:case c.EXT_WECHAT_SESSION_CARD:case c.EXT_WECHAT_SESSION_CARD_SYSTEM:case c.EXT_WECHAT_TIMELINE_CARD:case c.STAND_WECHAT_SESSION_CARD:case c.STAND_WECHAT_TIMELINE_CARD:return F.CARD;case c.WECHAT_TIMELINE_IMAGE:case c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:case c.WECHAT_SESSION_IMAGE:case c.QQ_CHAT_SESSION_IMAGE:case c.QQ_ZONE_IMAGE:case c.WEIBO_IMAGE:case c.WECHAT_TIMELINE_IMAGES:case c.WECHAT_SESSION_IMAGE_WITH_NO_SDK:case c.WECHAT_SESSION_IMAGES_WITH_NO_SDK:case c.SHARE_IMAGE_PASSIVELY:case c.EXT_WECHAT_SESSION_IMAGE:case c.EXT_WECHAT_SESSION_IMAGE_SYSTEM:case c.EXT_WECHAT_TIMELINE_IMAGE:case c.STAND_WECHAT_SESSION_IMAGE:case c.STAND_WECHAT_TIMELINE_IMAGE:return F.IMAGE;case c.WEIBO:case c.WECHAT_SESSION_TEXT_WITH_NO_SDK:case c.WECHAT_SESSION_TEXT:case c.WECHAT_TIMELINE_TEXT:case c.STAND_WECHAT_SESSION_TEXT:case c.STAND_WECHAT_TIMELINE_TEXT:return this.shortCommandApi?F.COMMAND:F.TEXT;case c.COPY_LINK:return F.COPY_LINK;case c.WECHAT_SESSION_APP:}return F.DEFAULT}},{key:"getShareMethod",value:function(e){switch(e){case c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK:case c.WECHAT_SESSION_TEXT_WITH_NO_SDK:case c.WECHAT_SESSION_IMAGE_WITH_NO_SDK:case c.WECHAT_SESSION_IMAGES_WITH_NO_SDK:case c.WECHAT_SESSION_CARD_WITH_NO_SDK:case c.WECHAT_TIMELINE_CARD_WITH_NO_SDK:return Q.SYSTEM;case c.WECHAT_SESSION:case c.QQ_CHAT_SESSION:case c.WECHAT_TIMELINE:case c.QQ_ZONE:case c.TENCENT_WEIBO:case c.WECHAT_TIMELINE_IMAGE:case c.WECHAT_SESSION_IMAGE:case c.QQ_CHAT_SESSION_IMAGE:case c.QQ_ZONE_IMAGE:case c.WEIBO_IMAGE:case c.WECHAT_TIMELINE_IMAGES:case c.WEIBO:case c.WECHAT_SESSION_TEXT:case c.WECHAT_TIMELINE_TEXT:case c.WECHAT_SESSION_MUSIC:case c.WECHAT_SESSION_VIDEO:case c.STAND_WECHAT_SESSION_TEXT:case c.STAND_WECHAT_TIMELINE_TEXT:return Q.SDK;case c.SHARE_IMAGE_PASSIVELY:return this.thirdPartyOpenType?Q.MANUAL:Q.DEFAULT;case c.EXT_WECHAT_SESSION_CARD:case c.EXT_WECHAT_SESSION_CARD_SYSTEM:case c.EXT_WECHAT_TIMELINE_CARD:case c.EXT_WECHAT_SESSION_IMAGE:case c.EXT_WECHAT_SESSION_IMAGE_SYSTEM:case c.EXT_WECHAT_TIMELINE_IMAGE:return Q.EXTENSION;case c.STAND_WECHAT_SESSION_CARD:case c.STAND_WECHAT_TIMELINE_CARD:case c.STAND_WECHAT_SESSION_IMAGE:case c.STAND_WECHAT_TIMELINE_IMAGE:return Q.STAND;case c.WECHAT_SESSION_APP:}return Q.DEFAULT}}]),t}(Je);lt.processDrawImageOptions=ot,lt.processDrawImageOptionsMuti=st;var _t=lt,Et={DEFAULT:0,OPEN_WECHAT:1,OPEN_QQ:2,OPEN_WEIBO:3,OPEN_WECHAT_IOS_SILENT:101,OPEN_WECHAT_ANDROID_SILENT:201};var ft,St=Ne.checkShareTypeSupport,pt=Ne.getShareModuleName,Tt=Ne.NATIVE_SAHRE_ERRORS,At=Object.keys(c).map(function(e){return c[e]}).filter(function(e){return[c.WECHAT_BIG_IMAGE].indexOf(e)<=0}),It=function(e){function t(e){var r;return o()(this,t),(r=A()(this,d()(t).call(this,e))).ShareEntityClass=_t,r._enableShareTypes=At.concat(),r.nativeShareEnv=Ne.getInstance(),r.shareLimiter=we(),r._isEnableShareCheck=!1,r.setShareCheck(!0),r}return m()(t,e),h()(t,[{key:"setShareCheck",value:function(e){Object(p.a)().isTinyNativePlatform?this._isEnableShareCheck=!0:this._isEnableShareCheck=!!e&&Ne.isEnableShareCheck()}},{key:"checkShareTypeEnable",value:function(e){var t=this.getShareEntityByShareType(e);if(!this.validateShareParams(e,t))return N.SHARE_PARAMS_NOT_VALID;if(!St(e)||this._enableShareTypes.indexOf(e)<0)return N.SHARE_TYPE_DISABLED;if(this._isEnableShareCheck&&[c.COPY_LINK].indexOf(e)<0){var r=this.shareLimiter.checkSync(e,t);if(r)return r}return 0}},{key:"share",value:function(e){var t=this.checkShareTypeEnable(e);return t||(e===c.PIN_TIMELINE?this._sharePinTimeline(e):e===c.WECHAT_BIG_IMAGE?this._nativeShareBigImage(e):[c.WECHAT_SESSION,c.WECHAT_TIMELINE,c.WEIBO,c.QQ_CHAT_SESSION,c.QQ_ZONE,c.TENCENT_WEIBO,c.WECHAT_SESSION_APP,c.FRIENDS,c.WECHAT_SESSION_MUSIC,c.WECHAT_SESSION_VIDEO,c.EXT_WECHAT_SESSION_CARD_SYSTEM,c.EXT_WECHAT_SESSION_CARD,c.EXT_WECHAT_TIMELINE_CARD,c.STAND_WECHAT_SESSION_CARD,c.STAND_WECHAT_TIMELINE_CARD].indexOf(e)>=0?this._nativeShareCard(e):[c.WECHAT_SESSION_CARD_WITH_NO_SDK,c.WECHAT_TIMELINE_CARD_WITH_NO_SDK].indexOf(e)>=0?this._nativeShareCardSpecial(e):[c.WECHAT_TIMELINE_IMAGE,c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK,c.WECHAT_SESSION_IMAGE,c.QQ_CHAT_SESSION_IMAGE,c.QQ_ZONE_IMAGE,c.WEIBO_IMAGE,c.WECHAT_SESSION_IMAGE_WITH_NO_SDK,c.SHARE_IMAGE_PASSIVELY,c.EXT_WECHAT_SESSION_IMAGE_SYSTEM,c.EXT_WECHAT_SESSION_IMAGE,c.EXT_WECHAT_TIMELINE_IMAGE,c.STAND_WECHAT_SESSION_IMAGE,c.STAND_WECHAT_TIMELINE_IMAGE].indexOf(e)>=0?this._nativeShareImage(e):[c.WECHAT_SESSION_TEXT_WITH_NO_SDK,c.WECHAT_SESSION_TEXT,c.WECHAT_TIMELINE_TEXT,c.STAND_WECHAT_SESSION_TEXT,c.STAND_WECHAT_TIMELINE_TEXT].indexOf(e)>=0?this._nativeShareText(e):c.COPY_LINK===e?this._nativeShareClipboard(e):N.SHARE_TYPE_NOT_FOUND)}},{key:"validateShareParams",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0}},{key:"_setupShareTypes",value:function(){}},{key:"refreshShare",value:function(e,r){var n=g()(d()(t.prototype),"refreshShare",this).call(this,e,r);return this.emit(l.ON_SHARE_PREPARE,{shareType:r}),n}},{key:"_setupPlatformShareSDK",value:function(){return this.waitShareLimiter()}},{key:"waitShareLimiter",value:function(){var e=this;return this._isEnableShareCheck?(this._queryShareTypePromise||(this._queryShareTypePromise=this.shareLimiter.build().catch(function(t){return e.emit(l.SHARE_LIMIT_LOAD_FAIL),Promise.resolve()})),this._queryShareTypePromise):Promise.resolve()}},{key:"_nativeShareCard",value:function(e){var t=this;this.emit(l.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.tpInfo,i=n.tpDowngrade;if(delete n.tpInfo,delete n.tpDowngrade,i||a&&!a.dev_app)t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL,tpDowngrade:!0,tpInfo:a});else{var o=Object.assign({type:e,redirect_uri:r.redirectURI||"",share_params:n,share_method:ce(r,e)});r.needSharedAmount&&(o.show_check_detail=1),a&&a.dev_type&&(o.dev_app=a.dev_app,o.dev_type=a.dev_type),t._invokeNativeShare(o,function(r){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS,responseData:r,tpInfo:a})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0,i=n===Tt.USER_CANCEL?tt.CANCEL:tt.FAIL;t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:i,nativeShareErrorCode:n,responseData:r.data,tpInfo:a})})}}),0}},{key:"_nativeShareCardSpecial",value:function(e){var t=this;this.emit(l.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then(function(n){var a=Object.assign({type:c.IOS_SYSTEM_SHARE_CARD,share_params:n,share_method:ce(r,e)});t._invokeNativeShare(a,function(r){var n=r.share_type,a=r.success,i="com.tencent.xin.sharetimeline"===n&&a;t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:i?tt.SUCCESS:tt.FAIL,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0,a=n===Tt.USER_CANCEL?tt.CANCEL:tt.FAIL;t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:a,nativeShareErrorCode:n,responseData:r.data})})}),0}},{key:"_nativeShareImage",value:function(e){var t=this;this.emit(l.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e),n=e;return r.normalize(e).then(function(a){var i={type:n,share_params:a,share_method:ce(r,e)},o=!1;n===c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK&&(i.complete=function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,useComplete:!0,shareResultType:tt.SUCCESS})},o=!0),t._invokeNativeShare(i,function(r){!o&&t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10),a=n===Tt.USER_CANCEL?tt.CANCEL:tt.FAIL;!o&&t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:a,nativeShareErrorCode:n,responseData:r.data})})}),0}},{key:"_nativeShareText",value:function(e){var t=this,r=this.getShareEntityByShareType(e),n=r.cipherScene&&"string"==typeof r.cipher;!n&&this.emit(l.ON_SHARE_TRIGGER,{shareType:e});var a=e;return r.normalize(e).then(function(i){n&&(t.emit(l.ON_SHARE_TRIGGER,{shareType:e,shareID:i.shareID}),delete i.shareID);var o=Object.assign({type:a,share_params:i,share_method:ce(r,e)}),s=!1;if(r.forceDowngrade||Object(p.a)().system===C.b.IOS&&a===c.WECHAT_SESSION_TEXT_WITH_NO_SDK)return t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL,shareParams:i}),0;Object(p.a)().system===C.b.Android&&a===c.WECHAT_SESSION_TEXT_WITH_NO_SDK&&(o.complete=function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,useComplete:!0,shareResultType:tt.SUCCESS})},s=!0),t._invokeNativeShare(o,function(r){!s&&t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0,a=n===Tt.USER_CANCEL?tt.CANCEL:tt.FAIL;!s&&t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:a,nativeShareErrorCode:n,responseData:r.data})})}),0}},{key:"_nativeShareBigImage",value:function(e){return N.SHARE_TYPE_DISABLED}},{key:"_nativeShareClipboard",value:function(e){var t=this;this.emit(l.ON_SHARE_TRIGGER,{shareType:e});var r=this.getShareEntityByShareType(e);return r.normalize(e).then(function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).share_url||r.shareURL;(Object(p.a)().isNativePlatform?new Promise(function(e,t){Object(O.d)("JSStorage","getPasteboard",null).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e(t.text)})}):Promise.reject()).then(null,function(){return Promise.resolve("")}).then(function(r){(function(e){return"string"!=typeof e?Promise.reject():Object(p.a)().isNativePlatform?Object(O.d)("JSStorage","setPasteboard",{text:e}):Promise.reject()})(n).then(function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS,content:n,originContent:r})},function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL,content:n,originContent:r})})})}),0}},{key:"_sharePinTimeline",value:function(e){var t=this;return this.emit(l.ON_SHARE_TRIGGER,{shareType:e}),this.getShareEntityByShareType(e).normalize(e).then(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({type:e,share_params:r});t._invokeNativeShare(n,function(r){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS,responseData:r})},function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=parseInt(r.errorCode,10)||0;t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL,nativeShareErrorCode:n,responseData:r.data})})}),0}},{key:"setupNativeShareButton",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.shareIcon,n=void 0===r?Ne.DEFAULT_SHARE_ICON:r,a=t.shareIconSize,i=void 0===a?Ne.DEFAULT_SHARE_ICON_SIZE:a;return"string"!=typeof n||"number"!=typeof i?N.SHARE_PARAMS_NOT_VALID:(Object(O.d)("JSUIControl","setRightBarButtons",{buttons:[{icons:{normal:n},callback:function(){e.emit(l.ON_SHARE_BUTTON_CLICKED)},size:i}]}),0)}},{key:"_invokeNativeShare",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=pt(),a="share",i=Object(Y.f)()+"";this._isEnableShareCheck?(e=Object.assign({origin:"h5",page_sn:i,page_info:{page_name:Object(Y.e)(),page_url:location&&location.href}},e),this.shareLimiter.getAppOptional()&&(e.app_optional=this.shareLimiter.getAppOptional()),a="performShare"):e.page_sn=i,Object(O.d)(n,a,e).then(t,r)}},{key:"shareCipherManually",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et.OPEN_WECHAT;return e&&"string"==typeof e?Ne.checkSupportShareCipher()?(t!==Et.OPEN_WECHAT&&t!==Et.OPEN_WECHAT_IOS_SILENT&&t!==Et.OPEN_WECHAT_ANDROID_SILENT||(t=Ne.checkSupportSilentWakeUp()&&this.shareLimiter.isSilentMode?Object(p.a)().system===C.b.IOS?Et.OPEN_WECHAT_IOS_SILENT:Et.OPEN_WECHAT_ANDROID_SILENT:Et.OPEN_WECHAT),Object(O.d)(pt(),"shareCipher",{cipher:e,open_type:t})):Promise.reject(new Error("not support")):Promise.reject(new Error("invalid cipher"))}}]),t}(et),dt=function(e){function t(){return o()(this,t),A()(this,d()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"normalize",value:function(e){var t=this;return new Promise(function(r,n){var a=Object.assign({},t),i=a.shareURL;t.targetShareURL=t.shareURL,t.realShareURL=t.shareURL,t.useShortURL=!1,e===c.WECHAT_TIMELINE||e===c.WECHAT_SESSION?Je.getWrappedShareURLInfo(a).then(function(e){var n=e.realShareURL,i=e.targetShareURL,o=e.useShortURL;t.useShortURL=o,t.targetShareURL=i,t.realShareURL=n,r({title:a.title,desc:a.message,imgUrl:a.thumbnailURL,link:n})},function(){}):ae(e)?(t.targetShareURL=Je.getQQShareURL(e,i),t.realShareURL=t.targetShareURL,r({title:a.title,desc:a.message,imgUrl:a.thumbnailURL,link:t.realShareURL})):r({title:a.title,desc:a.message,imgUrl:a.thumbnailURL,link:i})})}},{key:"getShareForm",value:function(e){return F.CARD}},{key:"getShareMethod",value:function(e){return Q.SDK}}]),t}(Je),vt=D.ShareErrorCode,gt=(ft={},oe()(ft,c.WECHAT_SESSION,{name:"onMenuShareAppMessage",tag:"menuItem:share:appMessage"}),oe()(ft,c.WECHAT_TIMELINE,{name:"onMenuShareTimeline",tag:"menuItem:share:timeline"}),oe()(ft,c.QQ_CHAT_SESSION,{name:"onMenuShareQQ",tag:"menuItem:share:qq"}),oe()(ft,c.QQ_ZONE,{name:"onMenuShareQZone",tag:"menuItem:share:QZone"}),oe()(ft,c.TENCENT_WEIBO,{name:"onMenuShareWeibo",tag:"menuItem:share:weiboApp"}),ft),yt=[c.WECHAT_SESSION,c.WECHAT_TIMELINE,c.QQ_CHAT_SESSION,c.QQ_ZONE,c.TENCENT_WEIBO],mt=function(e){function t(e){var r;return o()(this,t),(r=A()(this,d()(t).call(this,e))).ShareEntityClass=dt,r._enableShareTypes=yt.concat(),r}return m()(t,e),h()(t,[{key:"share",value:function(){return vt.SHARE_ACTION_DISABLE}},{key:"refreshShare",value:function(e,t){var r=this;return e?t?(this.shareEntityMap[t]=e,"undefined"==typeof wx?(this.emit(l.SDK_INIT_FAILED),Promise.resolve()):this.refreshWeChatChannelShare(t)):(this.shareEntity=e,this._enableShareTypes.forEach(function(t){r.shareEntityMap[t]=r.createShareEntity(e,t)}),this._setupPlatformShareSDK()):Promise.resolve()}},{key:"_setupShareTypes",value:function(){var e=this,t=this._enableShareTypes.length;return this._enableShareTypes=yt.filter(function(t){return e.disableShareTypes.indexOf(t)<0}),t===this._enableShareTypes.length}},{key:"_setupPlatformShareSDK",value:function(){var e=this;return"undefined"==typeof wx?(this.emit(l.SDK_INIT_FAILED),Promise.resolve()):Promise.all(this._enableShareTypes.map(function(t){e.refreshWeChatChannelShare(t)}))}},{key:"_adjustMenu",value:function(){var e=this,t=yt.filter(function(t){return e._enableShareTypes.indexOf(t)<0}).map(function(e){return gt[e].tag});window.wx&&window.wx.hideMenuItems({menuList:t})}},{key:"refreshWeChatChannelShare",value:function(e){var t=gt[e];return t?this._setupWeChatChannelShare(e,t.name):Promise.resolve()}},{key:"_setupWeChatChannelShare",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!window.wx||"function"!=typeof window.wx[r])return Promise.resolve();var n=this.shareEntityMap[e]||this.shareEntity;return n?(this.emit(l.ON_SHARE_PREPARE,{shareType:e}),n.normalize(e).then(function(n){var a=Object.assign({trigger:function(){t.emit(l.ON_SHARE_TRIGGER,{shareType:e})},success:function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS}),t.refreshWeChatChannelShare(e)},fail:function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL}),t.refreshWeChatChannelShare(e)},cancel:function(){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.CANCEL}),t.refreshWeChatChannelShare(e)}},n);window.wx[r](a)},function(){return Promise.resolve()})):Promise.resolve()}},{key:"checkShareTypeEnable",value:function(e){return this._enableShareTypes.indexOf(e)<0?vt.SHARE_TYPE_DISABLED:0}}]),t}(et);mt.SUPPORTED_SHARE_TYPE=yt.concat();var Ct,Ot,Rt=mt,Nt=function(e){function t(){return o()(this,t),A()(this,d()(t).apply(this,arguments))}return m()(t,e),h()(t,[{key:"normalize",value:function(e){var t=this;return new Promise(function(r,n){var a=Object.assign({},t);ae(e)?(t.targetShareURL=Je.getQQShareURL(e,a.shareURL),t.realShareURL=t.targetShareURL,r({title:a.title,desc:a.message,share_url:t.realShareURL,image_url:a.thumbnailURL,back:!0})):r({title:a.title,desc:a.message,share_url:a.shareURL,image_url:a.thumbnailURL,back:!0})})}},{key:"getShareForm",value:function(e){return F.CARD}},{key:"getShareMethod",value:function(e){return Q.SDK}}]),t}(Je),Lt=D.ShareErrorCode,Dt=[c.QQ_CHAT_SESSION,c.QQ_ZONE,c.WECHAT_SESSION,c.WECHAT_TIMELINE],bt=(Ct={},oe()(Ct,c.QQ_CHAT_SESSION,0),oe()(Ct,c.QQ_ZONE,1),oe()(Ct,c.WECHAT_SESSION,2),oe()(Ct,c.WECHAT_TIMELINE,3),Ct),Mt=(Ot={},oe()(Ot,c.QQ_CHAT_SESSION,"menuItem:share:qq"),oe()(Ot,c.QQ_ZONE,"menuItem:share:QZone"),oe()(Ot,c.WECHAT_SESSION,"menuItem:share:appMessage"),oe()(Ot,c.WECHAT_TIMELINE,"menuItem:share:timeline"),Ot),Pt=function(e){function t(e){var r;return o()(this,t),(r=A()(this,d()(t).call(this,e))).ShareEntityClass=Nt,r._enableShareTypes=Dt.concat(),r}return m()(t,e),h()(t,[{key:"share",value:function(e){var t=this;if(this._enableShareTypes.indexOf(e)<0)return Lt.SHARE_TYPE_DISABLED;if("undefined"==typeof mqq||void 0===window.mqq.ui)return Lt.SHARE_NOT_SUPPORTED;var r=this.getShareEntityByShareType(e);return this.emit(l.ON_SHARE_TRIGGER,{shareType:e}),r.normalize(e).then(function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.share_type=bt[e],window.mqq.ui.shareMessage(r,t.createShareCallback(e))}),0}},{key:"_adjustMenu",value:function(){var e=this,t=Dt.filter(function(t){return e._enableShareTypes.indexOf(t)<0}).map(function(e){return Mt[e]});window.mqq&&window.mqq.hideMenuItems({menuList:t})}},{key:"createShareCallback",value:function(e){var t=this;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(parseInt(r.retCode,10)){case 0:t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.SUCCESS});break;case 1:case-2:t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.CANCEL});break;default:t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL})}}}},{key:"_setupShareTypes",value:function(){var e=this,t=this._enableShareTypes.length;return this._enableShareTypes=Dt.filter(function(t){return(e.disableShareTypes||[]).indexOf(t)<0}),t===this._enableShareTypes.length}},{key:"_setupPlatformShareSDK",value:function(){var e=this;return"undefined"==typeof mqq||void 0===window.mqq.ui?(this.emit(l.SDK_INIT_FAILED),Promise.resolve()):(window.mqq.ui.setOnShareHandler(function(t){var r=Dt[parseInt(t,10)],n=e.getShareEntityByShareType(r);n&&(e.emit(l.ON_SHARE_TRIGGER,{shareType:r}),n.normalize(r).then(function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.share_type=t,window.mqq.ui.shareMessage(n,e.createShareCallback(r))}))}),Promise.resolve())}},{key:"checkShareTypeEnable",value:function(e){return this._enableShareTypes.indexOf(e)<0?Lt.SHARE_TYPE_DISABLED:0}}]),t}(et);Pt.SUPPORTED_SHARE_TYPE=Dt;var Ht=Pt,wt=function(e){function t(e){var r;return o()(this,t),(r=A()(this,d()(t).call(this,e))).wxAppShareMode=e.wxAppShareMode,r.wxAppRequestPayload=e.wxAppRequestPayload,r.miniObjectPath=e.miniObjectPath,r.shortCommandApi=e.shortCommandApi,r.wxAppNavigatePayload=e.wxAppNavigatePayload,r}return m()(t,e),h()(t,[{key:"normalize",value:function(){var e=S()(E.a.mark(function e(t){var r,n,a,i,o,s=this;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object.assign({},this),n=this.getShareForm.call(r,t),!([F.COMMAND,F.TEXT].indexOf(n)>=0)||!x(r.urlWrapType)){e.next=7;break}return a={title:r.title,desc:r.message,thumbnail:r.thumbnailURL,share_url:r.shareURL,share_id:r.shareID},i=a.title||"",e.abrupt("return",Je.getWrappedShareURLInfo(r).then(function(e){var t=e.realShareURL,n=e.targetShareURL,o=e.useShortURL,h=e.shareText;if(s.targetShareURL=n,r.shortCommandApi){var u=o?h:"";i=Ze(i,u||n,n,u),a.title=a.desc=i,s.pcode=i}else{var c=o?t:"",l=c||n;i=Ze(i,l,n,c),a.title=a.desc=i,s.useShortURL=o,s.realShareURL=l}return a}));case 7:if((o=r.miniObjectPath)&&"string"==typeof o)o=z(r);else if("function"==typeof o)try{"string"!=typeof(o=o(r.shareURL))&&(o=null)}catch(e){}return e.abrupt("return",Promise.resolve(Object.assign({},r.wxAppNavigatePayload,{title:r.title,thumbnail:r.thumbnailURL,share_url:o||Z(r.shareURL)})));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getShareForm",value:function(e){return[c.WECHAT_SESSION_TEXT,c.WECHAT_SESSION_TEXT_WITH_NO_SDK].indexOf(e)>=0?this.shortCommandApi?F.COMMAND:F.TEXT:F.WXAPP_CARD}},{key:"getShareMethod",value:function(e){return Q.SDK}}]),t}(Je),Ut={NAVIGATE:0,REQUEST:1},kt=r("3sKm"),Wt="";function xt(){return Object(kt.b)().then(function(e){Wt=e}).catch(function(e){return""})}function jt(){return Wt}var Bt="api/dcproxy/message/unicast",Gt=6,Ft=2,Qt=1;function Yt(){return(Yt=S()(E.a.mark(function e(){var t,r,n,a,i=arguments;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),e.t0=Gt,e.t1={code:Qt,params:t},e.t2=Ft,e.next=7,jt();case 7:return e.t3=e.sent,n={action_id:e.t0,payload:e.t1,os:e.t2,pdd_uid:e.t3},a=r.post(Bt,n),e.abrupt("return",a.then(function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).magic_trace}));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Kt=D.ShareErrorCode,Xt=[c.WECHAT_SESSION],qt=function(e){function t(e){var r;return o()(this,t),(r=A()(this,d()(t).call(this,e))).ShareEntityClass=wt,r._enableShareTypes=Xt.concat(),r}return m()(t,e),h()(t,[{key:"share",value:function(e){if([c.WECHAT_SESSION_TEXT,c.WECHAT_SESSION_TEXT_WITH_NO_SDK].indexOf(e)>=0)return this._shareText(e);if(e!==c.WECHAT_SESSION)return Kt.SHARE_ACTION_DISABLE;var t=this.getShareEntityByShareType(e);return t?t.wxAppShareMode===Ut.REQUEST?this._shareByRequest():this._shareByNavigate():Kt.SHARE_PARAMS_NOT_VALID}},{key:"_shareByNavigate",value:function(){var e=this;if(!window.wx||!window.wx.miniProgram||"function"!=typeof window.wx.miniProgram.navigateTo)return Kt.SHARE_NOT_SUPPORTED;var t=c.WECHAT_SESSION,r=this.getShareEntityByShareType(t);return this.emit(l.ON_SHARE_TRIGGER,{shareType:t}),r.normalize(t).then(function(r){window.wx.miniProgram.navigateTo({url:"".concat("/pages/web_share/web_share?").concat(Object(u.b)(Object.assign({page_sn:Object(Y.f)()+"",page_name:Object(Y.e)(),page_id:Object(Y.c)()},r)))}),e.emit(l.ON_SHARE_COMPLETED,{shareType:t,shareResultType:tt.SUCCESS})}),0}},{key:"_shareByRequest",value:function(){var e=this,t=c.WECHAT_SESSION,r=this.getShareEntityByShareType(t);this.emit(l.ON_SHARE_TRIGGER,{shareType:t});var n=r.wxAppRequestPayload||{};return function(){return Yt.apply(this,arguments)}(Object.assign({pageSn:Object(Y.f)()+"",pageName:Object(Y.e)(),shareInfo:{shareURL:Z(location&&location.href)}},n)).then(function(){e.emit(l.ON_SHARE_COMPLETED,{shareType:t,shareResultType:tt.SUCCESS})},function(r){e.emit(l.ON_SHARE_COMPLETED,{shareType:t,shareResultType:tt.FAIL,error:r})}),0}},{key:"refreshWxAppChannelShare",value:function(e){return this._setupPlatformShareSDK()}},{key:"notifyWxAppShareComplete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tt.SUCCESS;this.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:t}),this.refreshWxAppChannelShare(e)}},{key:"_setupPlatformShareSDK",value:function(){var e=this;return"object"!==("undefined"==typeof wx?"undefined":a()(wx))||"object"!==a()(window.wx.miniProgram)||"function"!=typeof window.wx.miniProgram.postMessage?(this.emit(l.SDK_INIT_FAILED),Promise.resolve()):Promise.all(this._enableShareTypes.map(function(t){var r=e.getShareEntityByShareType(t);return r?(e.emit(l.ON_SHARE_PREPARE,{shareType:t}),r.normalize(t).then(function(e){try{window.wx.miniProgram.postMessage({data:{message_type:"share",share_info:e,page_info:{page_sn:Object(Y.f)()+"",page_name:Object(Y.e)(),page_id:Object(Y.c)()}}})}catch(e){}})):Promise.resolve()}))}},{key:"_shareText",value:function(e){var t=this,r=this.getShareEntityByShareType(e);return this.emit(l.ON_SHARE_TRIGGER,{shareType:e}),r.normalize(e).then(function(r){t.emit(l.ON_SHARE_COMPLETED,{shareType:e,shareResultType:tt.FAIL,shareParams:r})}),0}}]),t}(et),Vt={SUCCESS:"success",FAIL:"fail",CANCEL:"cancel",COMPLETE:"complete",ERROR:"error"},Zt="event",zt={SHARE:"share",SHARE_RESULT:"share_result"},Jt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.userID=t.userID||"",this.shareID=t.shareID||"",this.op=t.op||Zt,this.subOP=t.subOP||"",this.shareChannel=t.shareChannel||"",this.shareResult=t.shareResult||"",this.shareURL=t.shareURL||"",this.shareDomain=t.shareDomain||"",this.shareForm=t.shareForm||"",this.shareMethod=t.shareMethod||"",this.shareAppID=t.shareAppID,this.pcode=t.pcode,this.wxShareCount=t.wxShareCount,this.cipherScene=t.cipherScene}return h()(e,[{key:"normalize",value:function(e){if(this.subOP===zt.SHARE)return{op:this.op,sub_op:this.subOP,share_id:this.shareID,share_channel:this.shareChannel,share_url:this.shareURL,share_domain:this.shareDomain,share_form:this.shareForm,share_method:this.shareMethod,share_app_id:this.shareAppID,pcode:this.pcode,pcode_scene:this.cipherScene};if(this.subOP===zt.SHARE_RESULT){var t={op:this.op,sub_op:this.subOP,event:"share_result",share_id:this.shareID,share_channel:this.shareChannel,share_url:this.shareURL,share_domain:this.shareDomain,share_result:this.shareResult,share_form:this.shareForm,share_method:this.shareMethod,share_app_id:this.shareAppID,wx_share_count:this.wxShareCount,pcode:this.pcode,pcode_scene:this.cipherScene};return this.walrusID&&(t.walrus_id=this.walrusID,t.walrus_type=this.walrusType),t}return{}}},{key:"getShareURLTrackingQueries",value:function(){return e.getTrackingQueries(this)}}]),e}();Jt.TRACKING_SUB_OP=zt,Jt.getTrackingQueries=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{refer_share_id:e.shareID,refer_share_uid:e.userID,refer_share_channel:e.shareChannel}};var $t=Jt;function er(e){return e=e||32,Object(b.a)(e)}var tr,rr,nr={UNKNOWN:"unknown",APP_MESSAGE:"message",TIMELINE:"timeline",QQ:"qq",QQ_ZONE:"qzone",QQ_WEIBO:"qq_weibo",SINA_WEIBO:"weibo",CLIPBOARD:"copy_link"},ar=(tr={},oe()(tr,c.WECHAT_SESSION,nr.APP_MESSAGE),oe()(tr,c.WECHAT_TIMELINE,nr.TIMELINE),oe()(tr,c.WEIBO,nr.SINA_WEIBO),oe()(tr,c.QQ_CHAT_SESSION,nr.QQ),oe()(tr,c.QQ_ZONE,nr.QQ_ZONE),oe()(tr,c.TENCENT_WEIBO,nr.QQ_WEIBO),oe()(tr,c.WECHAT_SESSION_APP,nr.APP_MESSAGE),oe()(tr,c.WECHAT_TIMELINE_IMAGE,nr.TIMELINE),oe()(tr,c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK,nr.TIMELINE),oe()(tr,c.WECHAT_SESSION_IMAGE,nr.APP_MESSAGE),oe()(tr,c.QQ_CHAT_SESSION_IMAGE,nr.QQ),oe()(tr,c.QQ_ZONE_IMAGE,nr.QQ_ZONE),oe()(tr,c.WEIBO_IMAGE,nr.SINA_WEIBO),oe()(tr,c.FRIENDS,nr.UNKNOWN),oe()(tr,c.WECHAT_BIG_IMAGE,nr.APP_MESSAGE),oe()(tr,c.WECHAT_SESSION_TEXT_WITH_NO_SDK,nr.APP_MESSAGE),oe()(tr,c.WECHAT_SESSION_TEXT,nr.APP_MESSAGE),oe()(tr,c.WECHAT_SESSION_IMAGE_WITH_NO_SDK,nr.APP_MESSAGE),oe()(tr,c.WECHAT_SESSION_IMAGES_WITH_NO_SDK,nr.APP_MESSAGE),oe()(tr,c.WECHAT_TIMELINE_TEXT,nr.TIMELINE),oe()(tr,c.WECHAT_SESSION_CARD_WITH_NO_SDK,nr.APP_MESSAGE),oe()(tr,c.WECHAT_TIMELINE_CARD_WITH_NO_SDK,nr.TIMELINE),oe()(tr,c.COPY_LINK,nr.CLIPBOARD),oe()(tr,c.WECHAT_SESSION_MUSIC,nr.APP_MESSAGE),oe()(tr,c.WECHAT_SESSION_VIDEO,nr.APP_MESSAGE),oe()(tr,c.EXT_WECHAT_SESSION_CARD_SYSTEM,nr.APP_MESSAGE),oe()(tr,c.EXT_WECHAT_SESSION_IMAGE_SYSTEM,nr.APP_MESSAGE),oe()(tr,c.EXT_WECHAT_SESSION_CARD,nr.APP_MESSAGE),oe()(tr,c.EXT_WECHAT_TIMELINE_CARD,nr.TIMELINE),oe()(tr,c.EXT_WECHAT_SESSION_IMAGE,nr.APP_MESSAGE),oe()(tr,c.EXT_WECHAT_TIMELINE_IMAGE,nr.TIMELINE),oe()(tr,c.STAND_WECHAT_SESSION_CARD,nr.APP_MESSAGE),oe()(tr,c.STAND_WECHAT_SESSION_IMAGE,nr.APP_MESSAGE),oe()(tr,c.STAND_WECHAT_TIMELINE_CARD,nr.TIMELINE),oe()(tr,c.STAND_WECHAT_TIMELINE_IMAGE,nr.TIMELINE),oe()(tr,c.STAND_WECHAT_SESSION_TEXT,nr.APP_MESSAGE),oe()(tr,c.STAND_WECHAT_TIMELINE_TEXT,nr.TIMELINE),tr);function ir(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return ar[e]||nr.UNKNOWN}var or={DEFAULT:0,WECHAT:1,QQ:2,WEIBO:3},sr=(rr={},oe()(rr,nr.UNKNOWN,or.DEFAULT),oe()(rr,nr.APP_MESSAGE,or.WECHAT),oe()(rr,nr.TIMELINE,or.WECHAT),oe()(rr,nr.QQ,or.QQ),oe()(rr,nr.QQ_ZONE,or.QQ),oe()(rr,nr.QQ_WEIBO,or.QQ),oe()(rr,nr.SINA_WEIBO,or.WEIBO),rr);var hr=function(e){return sr[e]||or.DEFAULT},ur=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];o()(this,e),this._venderAppIDs={},this._isInited=!1}return h()(e,[{key:"build",value:function(e){var t=e.wechatAppID;return this._isInited?Promise.resolve():(this._isInited=!0,Object(p.a)().isNativePlatform?this._buildNativeCache():Object(p.a)().isWeChatPlatform?this._buildWeChatCache(t):Promise.resolve())}},{key:"isInited",value:function(){return this._isInited}},{key:"_buildNativeCache",value:function(){var e=this;return Ne.getVenderAppIds([or.WECHAT]).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e._venderAppIDs=Object.assign(e._venderAppIDs,t)}).catch(function(){return Promise.resolve()})}},{key:"_buildWeChatCache",value:function(e){return this._venderAppIDs[or.WECHAT]=e,Promise.resolve()}},{key:"getAppIDSync",value:function(e){var t=hr(e);return this._venderAppIDs[t]}}]),e}(),cr=null;ur.getInstance=function(e){return cr||(cr=new ur(e)),cr};var lr=ur,_r=D.ShareErrorCode,Er=$t.TRACKING_SUB_OP;var fr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.transparentTransmission=t.transparentTransmission||{},this.trackingEntity=null,this.onTriggerListener=null,this.onCompletedListener=null,this.shareController=null,this._cachePrepareInfo={}}return h()(e,[{key:"listen",value:function(e){e&&e instanceof et&&(this.shareController=e,this._setupDefaultTrackListener(e))}},{key:"disconnect",value:function(){this.shareController&&this._removeDefaultTrackListener(this.shareController)}},{key:"updateTrackerTrans",value:function(e){this.transparentTransmission=Object.assign({},this.transparentTransmission,e)}},{key:"_setupDefaultTrackListener",value:function(e){this._removeDefaultTrackListener(e),this.onPrepareListener=this._onDefaultSharePrepare.bind(this),this.onTriggerListener=this._onDefaultShareTrigger.bind(this),this.onCompletedListener=this._onDefaultShareCompleted.bind(this),e.on(l.ON_SHARE_PREPARE,this.onPrepareListener),e.on(l.ON_SHARE_TRIGGER,this.onTriggerListener),e.on(l.ON_SHARE_COMPLETED,this.onCompletedListener)}},{key:"_removeDefaultTrackListener",value:function(e){this.onPrepareListener&&e.removeListener(l.ON_SHARE_PREPARE,this.onPrepareListener),this.onTriggerListener&&e.removeListener(l.ON_SHARE_TRIGGER,this.onTriggerListener),this.onCompletedListener&&e.removeListener(l.ON_SHARE_COMPLETED,this.onCompletedListener)}},{key:"_sendLog",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign(e,this.transparentTransmission);Le.a.trackingRecord(t)}},{key:"_onDefaultSharePrepare",value:function(e){var t=e.shareType;if(this._cachePrepareInfo[t]){var r=this.shareController.getShareEntityByShareType(t)||{},n=this._cachePrepareInfo[t];return n.userID=jt(),void r.setShareURLQueries($t.getTrackingQueries(n))}var a=this.shareController.getShareEntityByShareType(t),i={userID:jt(),shareID:this._getCachedShareID(a)||er(),shareChannel:ir(t)};a&&a.setShareURLQueries($t.getTrackingQueries(i)),this._cachePrepareInfo[t]=i}},{key:"_onDefaultShareTrigger",value:function(e){var t=e.shareType,r=e.shareID;if(t===c.PIN_TIMELINE||Object(p.a)().isWeChatMiniProgram&&t===c.WECHAT_SESSION)return 0;var n=this.shareController.getShareEntityByShareType(t)||{},a=this._cachePrepareInfo[t];this._cachePrepareInfo[t]=null;var i=ir(t),o=lr.getInstance();if(this.trackingEntity=new $t(Object.assign({userID:jt(),shareID:this._getCachedShareID(n)||er(),subOP:Er.SHARE,shareChannel:i,timelineDomain:n.timelineDomain,cipherScene:n.cipherScene,shareForm:n.getShareForm&&n.getShareForm(t),shareMethod:n.getShareMethod&&n.getShareMethod(t),shareAppID:o.getAppIDSync(i)},a,r?{shareID:r}:null)),!a&&n.setShareURLQueries($t.getTrackingQueries(this.trackingEntity)),n.getShareForm(t)!==F.COMMAND){var s=n.targetShareURL||n.shareURL;this.trackingEntity.shareURL=s,this.trackingEntity.shareDomain=new w(s).origin}this._sendLog(this.trackingEntity.normalize(t))}},{key:"_onDefaultShareCompleted",value:function(e){var t=e.shareType,r=e.shareResultType,n=e.useComplete,i=e.responseData,o=void 0===i?{}:i,s=e.tpInfo;if(t===c.PIN_TIMELINE||Object(p.a)().isWeChatMiniProgram&&t===c.WECHAT_SESSION)return 0;if(!this.trackingEntity)return _r.SHARE_STATUS_ILLEGAL;var h=this.shareController.getShareEntityByShareType(t)||{},u=this.getShareResultByType(r);if(n&&(u=Vt.COMPLETE),h.getShareForm(t)!==F.COMMAND){var l=h.realShareURL||h.shareURL;this.trackingEntity.shareURL=l,this.trackingEntity.shareDomain=new w(l).origin}else this.trackingEntity.pcode=h.pcode;var _=function(e){return e&&"object"===a()(e)?"string"!=typeof e.wx_app_id?null:e.wx_app_id:null}(o);_&&(this.trackingEntity.shareAppID=_),o.hasOwnProperty("wx_share_count")&&(this.trackingEntity.wxShareCount=o.wx_share_count,delete o.wx_share_count),this.trackingEntity.subOP=Er.SHARE_RESULT,this.trackingEntity.shareResult=u,s&&(this.trackingEntity.walrusID=s.group_id,this.trackingEntity.walrusType=s.dev_type),h.forceDowngrade||Object(p.a)().platform===C.a.PddIOS&&t===c.WECHAT_SESSION_TEXT_WITH_NO_SDK||(this._sendLog(this.trackingEntity.normalize(t)),this.trackingEntity=null)}},{key:"trackProlongation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(!this.trackingEntity)return!1;this.trackingEntity.shareMethod=Q.MANUAL,this.trackingEntity.shareResult=Vt.COMPLETE;var n=Object.assign(this.trackingEntity.normalize(e),t);return this.trackingEntity=null,"function"==typeof r?r(n):this._sendLog(n),!0}},{key:"getShareResultByType",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0){case tt.COMPLETE:return Vt.COMPLETE;case tt.SUCCESS:return Vt.SUCCESS;case tt.FAIL:return Vt.FAIL;case tt.CANCEL:return Vt.CANCEL;default:return Vt.ERROR}}},{key:"_getCachedShareID",value:function(e){if(e.urlWrapType===j.SERVER_SHORT_URL_WITH_CACHE){var t=ye(),r=Ae(e);return t.getShareID(r)}}}]),e}(),Sr={REACH_HOUR_LIMIT:43367,REACH_DAY_LIMIT:43368},pr=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];o()(this,e),this._shareController=null,this._onPerformShareErrorHandler=null}return h()(e,[{key:"listen",value:function(e){e&&e instanceof et&&(this._shareController=e,this._setupListener(e))}},{key:"disconnect",value:function(){this.removeListener()}},{key:"_setupListener",value:function(e){this.removeListener(),this._onPerformShareErrorHandler=this._onPerformShareError.bind(this),e.on(l.PERFORM_LOG_FAILED,this._onPerformShareErrorHandler)}},{key:"removeListener",value:function(){this._shareController&&this._onPerformShareErrorHandler&&this._shareController.removeListener(l.PERFORM_LOG_FAILED,this._onPerformShareErrorHandler)}},{key:"_onPerformShareError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.error||{},r=e.shareType,n=parseInt(t.errorCode,10)||0;[Sr.REACH_DAY_LIMIT,Sr.REACH_HOUR_LIMIT].indexOf(n)>=0&&(this._shareController.emit(l.SHARE_REACH_LIMIT,{shareType:r,errorCode:n}),this.hideShareMenuOption(r))}},{key:"hideShareMenuOption",value:function(e){var t=this._shareController;e&&t&&t.disableShare(e)}}]),e}(),Tr="undefined"!=typeof window,Ar=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.shareController=null,this.shareTracker=null,this.menuWatcher=null,this.platform=le(),this._disableContentCheck=!1,this._disablePerformShareLog=!1,this.controllerOptions=t.controllerOptions||{},this.noDefaultShare=t.noDefaultShare||!1,this.disableShare=t.disableShare||!1}return h()(e,[{key:"setup",value:function(){Tr&&(this._setupController(),this._setupShareTracker(),this._setupMenuWatcher(),this._setupPerformShareLog())}},{key:"_setupController",value:function(){var e=this;if(!this.shareController){var t=this.controllerOptions,r=Object(p.a)();r.isWeChatMiniProgram?this.shareController=new qt(t):r.isWeChatPlatform?(this.shareController=new Rt(t),this.noDefaultShare||this._prepareShareController()):r.isQQPlatform?(this.shareController=new Ht(t),this.noDefaultShare||this._prepareShareController()):(r.isNativePlatform||r.isTinyNativePlatform)&&(this.shareController=new It(t),this.shareController.on(l.ON_SHARE_COMPLETED,function(t){var r=t.shareType,n=t.shareResultType,a=t.nativeShareErrorCode;n===tt.FAIL&&[Sr.REACH_HOUR_LIMIT,Sr.REACH_DAY_LIMIT].indexOf(a)>=0&&(e.shareController.emit(l.SHARE_REACH_LIMIT,{shareType:r,errorCode:a}),De({errorCode:a,message:""}))}))}}},{key:"_prepareShareController",value:function(){this.shareController&&!this.shareController.isInited()&&this.shareController.initShare()}},{key:"_setupMenuWatcher",value:function(){this.menuWatcher||(this.menuWatcher=new pr,this.menuWatcher.listen(this.shareController))}},{key:"_setupShareTracker",value:function(){this.disableTracker||this.shareTracker||(this.shareTracker=new fr({transparentTransmission:this.trackerTrans}),this.shareTracker.listen(this.shareController))}},{key:"_setupPerformShareLog",value:function(){var e=this;this.shareController&&!Object(p.a)().isNativePlatform&&this.shareController.on(l.ON_SHARE_COMPLETED,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e._disablePerformShareLog&&t.shareResultType===tt.SUCCESS){var r=t.shareType,n=e.getShareEntity(r);(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n={};return n.share_params=t.shareParams||{},n.share_type=t.shareType||0,n.share_method=t.shareMethod||"",n.origin=t.platform||"",n.page_sn=t.pageSn||Object(Y.f)(),n.page_info=t.pageInfo||{page_name:Object(Y.e)(),page_url:location&&location.href},n.extra=t.extra||{},"post"===e.toLowerCase()?r.post("api/flow/audience/share/perform",n):r.get("api/flow/audience/share/perform",{params:n})})("post",{platform:e.platform,shareType:r,shareParams:ue(n),shareMethod:ce(n,r),extra:n.payloadMixin&&n.payloadMixin.extra}).catch(function(t){e.shareController.emit(l.PERFORM_LOG_FAILED,{shareType:r,error:t})})}})}},{key:"share",value:function(){var e=S()(E.a.mark(function e(t){var r,n=this;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.shareController&&!this.disableShare){e.next=2;break}return e.abrupt("return",Promise.reject());case 2:return e.next=4,xt();case 4:if(this._prepareShareController(),r=function(){return new Promise(function(e,r){var a=n,i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.shareResultType;o(),tt.SUCCESS===n?e(t):r(t)};function o(){a.shareController.removeListener(l.ON_SHARE_COMPLETED,i)}n.shareController.on(l.ON_SHARE_COMPLETED,i);var s=n.shareController.share(t);s&&(o(),n.shareController.emit(l.ON_SHARE_INTERRUPT,{shareType:t,shareErrorType:s}),De({errorCode:s,message:"",options:{shareType:t}}),r({shareType:t,shareErrorType:s}))})},!Object(p.a)().isNativePlatform){e.next=10;break}return e.abrupt("return",this.shareController.waitShareLimiter().then(function(e){return r()},function(e){return r()}));case 10:return e.abrupt("return",r());case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"checkShareContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(K.a)({pageInfo:{pageId:Object(Y.c)()}},{defaultErrorHandler:function(e){}}),n={};return n.share_params=t.shareParams||{},n.origin=t.platform||"",n.page_sn=t.pageSn||Object(Y.f)()+"",n.page_info=t.pageInfo||{page_name:Object(Y.e)(),page_url:location&&location.href},"post"===e.toLowerCase()?r.post("api/flow/audience/share/content",n):r.get("api/flow/audience/share/content",{params:n})}("post",{platform:this.platform,shareParams:ue(e)})}},{key:"setContentCheck",value:function(e){this._disableContentCheck=!e}},{key:"setPerformShareLog",value:function(e){this._disablePerformShareLog=!e}},{key:"prepareShare",value:function(){var e=S()(E.a.mark(function e(){var t,r,n,a,i,o,s,h,u=this,c=arguments;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=c.length>0&&void 0!==c[0]?c[0]:{},r=c.length>1?c[1]:void 0,n=c.length>2&&void 0!==c[2]?c[2]:{},this.shareController){e.next=5;break}return e.abrupt("return",Promise.resolve());case 5:return e.next=7,xt();case 7:if(this._prepareShareController(),a=t.entityConfig,i=void 0===a?{}:a,o=t.statisticsConfig,s=void 0===o?{}:o,this.shareTracker&&this.shareTracker.updateTrackerTrans(s),h=this.shareController.createShareEntity(i,r),!(n.skipShareContentCheck||this._disableContentCheck||Object(p.a)().isNativePlatform)){e.next=13;break}return e.abrupt("return",this.shareController.refreshShare(h,r));case 13:return e.abrupt("return",this.checkShareContent(h).then(function(){return u.shareController.refreshShare(h,r)}));case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getShareController",value:function(){return this.shareController}},{key:"getShareTracker",value:function(){return this.shareTracker}},{key:"getShareEntity",value:function(e,t){return this.shareController?this.shareController.getShareEntityByShareType(e,t):null}},{key:"setupNativeShareButton",value:function(e,t){this.shareController&&(this.shareController.removeAllListeners(l.ON_SHARE_BUTTON_CLICKED),"function"==typeof t&&this.shareController.on(l.ON_SHARE_BUTTON_CLICKED,t),this.shareController.setupNativeShareButton(e))}}]),e}(),Ir={USELESS:-1,DEFAULT:0,OUT_OF_DATE:1,FORBIDDEN:2,ABANDONED:3},dr={title:Ir.DEFAULT,message:Ir.DEFAULT,thumbnailURL:Ir.DEFAULT,shareURL:Ir.DEFAULT,shareDomain:Ir.DEFAULT,waterMark:Ir.DEFAULT,timelineDomain:Ir.DEFAULT,timelineAppId:Ir.DEFAULT,urlWrapType:Ir.DEFAULT,drawImageOptions:Ir.DEFAULT,drawImageClass:Ir.DEFAULT,marketActivityID:Ir.DEFAULT,addRandomPrefix:Ir.DEFAULT,miniObjectPath:Ir.DEFAULT,miniObjectID:Ir.DEFAULT,useWxAppShare:Ir.DEFAULT,shortURLApi:Ir.DEFAULT,shortCommandApi:Ir.DEFAULT,domainURLApi:Ir.DEFAULT,forceDowngrade:Ir.DEFAULT,payloadMixin:Ir.DEFAULT,requestUsePost:Ir.DEFAULT,excludeShareChoices:Ir.DEFAULT,thirdPartyOpenType:Ir.DEFAULT,needSharedAmount:Ir.DEFAULT,maskTemplateID:Ir.DEFAULT,maskData:Ir.DEFAULT,cipherScene:Ir.DEFAULT,consumeMode:Ir.DEFAULT,activitySceneSn:Ir.DEFAULT,tpSelectCategory:Ir.DEFAULT,pinTimelineParams:Ir.DEFAULT,wxAppShareMode:Ir.DEFAULT,wxAppRequestPayload:Ir.DEFAULT,cipherProcessor:Ir.DEFAULT,wxAppNavigatePayload:Ir.DEFAULT},vr={},gr={onlyWeChat:Ir.USELESS,noDefaultShare:Ir.DEFAULT,isSDKPrepare:Ir.DEFAULT,disableShare:Ir.DEFAULT,disableCopyUrl:Ir.USELESS,enableBroswerOpen:Ir.USELESS},yr={cid:Ir.DEFAULT,campaign:Ir.DEFAULT},mr={wechatAppID:Ir.DEFAULT,magicTrace:Ir.DEFAULT,shareTypeEnable:Ir.DEFAULT},Cr=Ir,Or=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this.cacheRaw=t.cacheRaw||!1,this.deleteAfterCollect=t.deleteAfterCollect||!1}return h()(e,[{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._filterShareEntity(e),r=this._filterShareCallbacks(e),n=this._filterStatistics(e),a=this._filterShareConfigFlag(e),i=this._filterShareOther(e);return{_rawShareInfo:this.cacheRaw?e:null,entityConfig:t,callbackConfig:r,statisticsConfig:n,flowControllConfig:a,otherConfig:i,compatibleShareConfig:{}}}},{key:"_filterByItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};return(Object.keys(r)||[]).forEach(function(a,i){var o=r[a];o===Cr.FORBIDDEN?delete t[a]:o===Cr.ABANDONED?delete t[a]:void 0!==t[a]&&(n[a]=t[a],e.deleteAfterCollect&&delete t[a])}),n}},{key:"_filterShareEntity",value:function(e){return this._filterByItems(e,dr)}},{key:"_filterShareConfigFlag",value:function(e){return this._filterByItems(e,gr)}},{key:"_filterShareCallbacks",value:function(e){return this._filterByItems(e,vr)}},{key:"_filterStatistics",value:function(e){return this._filterByItems(e,yr)}},{key:"_filterShareOther",value:function(e){return this._filterByItems(e,mr)}}]),e}(),Rr={DEFAULT:"!share_v2",WE_CHAT_MSG:"!share_v3",SHARE:"!share",TRANSPARENT:"!transparent",NONE:"",NO_LOGO:"!share_v4"},Nr={};"undefined"!=typeof window&&(Nr=X.a.get(location.host)||{});var Lr={code:null,from:null,isappinstalled:null,at:null,share_id:null,is_back:null,page_id:null,list_id:null},Dr=["refer_page_name","refer_page_section","refer_page_element","refer_page_id","refer_page_sn","refer_page_el_sn","refer_mid","refer_adg","refer_cam","refer_ced"];function br(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=e||"").indexOf("!")>=0&&!r?e:(e=e.split("!")[0],e+=t)}var Mr=null,Pr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o()(this,e),this._hasInited=!1,this.opts=t||{},this.shopConfig=t.shopConfig,this.defaultShareEntityConfig={},this.shareManager=null,this.shareInfoFilter=null,this._sdkPrepared=!1,this.setup()}return h()(e,[{key:"setup",value:function(){this._hasInited||(this._hasInited=!0,this._setupShareInfoFilter(),this._setupShareManager(),!(this.opts.shareManagerConfig||{}).noDefaultShare&&this._prepareDefaultShare(),this.waitAppIDCacheBuild())}},{key:"_setupShareInfoFilter",value:function(){this.shareInfoFilter||(this.shareInfoFilter=new Or(this.opts.shareInfoFilterConfig))}},{key:"_setupShareManager",value:function(){if(!this.shareManager){var e=Object.assign({},{noDefaultShare:!1,disableShare:!1,useNativeShareButton:!1},this.opts.shareManagerConfig);this.shareManager=new Ar(e),this.shareManager.setup()}}},{key:"_prepareDefaultShare",value:function(){if(!Object(p.a)().isWeChatMiniProgram){var e=this.shopConfig||Nr.shop||{},t=e.name||"";Object.assign(this.defaultShareEntityConfig,{title:"".concat(t,""),message:"".concat(t,""),thumbnailURL:e.logo,shareURL:"/"}),this.prepareShare(this.defaultShareEntityConfig,void 0,{skipShareContentCheck:!0})}}},{key:"_prepareShareByShareType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;if(!this._hasInited)return Promise.reject();var n=e.entityConfig,a=void 0===n?{}:n;return this._buildThumbnailURL(a,t),this._buildShareURL(a,t),this.shareManager.prepareShare(e,t,r)}},{key:"prepareShare",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this._hasInited)return Promise.reject();var a=this.shareInfoFilter.filter(e),i=this._prepareShareByShareType(a,t,n);return!this._sdkPrepared&&i.then(function(e){r._checkSDKPrepared(a)},function(e){r._checkSDKPrepared(a)}),i}},{key:"prepareShareSafe",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(!this._hasInited)return Promise.reject();var n=this.shareInfoFilter.filter(t),a=n.flowControllConfig,i=void 0===a?{}:a;if(!this._sdkPrepared&&!i.isSDKPrepare)return this.waitSDKReady().then(function(){return e._prepareShareByShareType(n,r)});var o=this._prepareShareByShareType(n,r);return!this._sdkPrepared&&o.then(function(t){e._checkSDKPrepared(n)},function(t){e._checkSDKPrepared(n)}),o}},{key:"waitSDKReady",value:function(){var e=this;return this.waitWeChatSDKReady().then(function(){return e.waitAppIDCacheBuild()})}},{key:"waitWeChatSDKReady",value:function(){if(this._sdkPrepared)return Promise.resolve();if(this.sdkReadyPromise)return this.sdkReadyPromise;var e=this.shareManager.getShareController();return e?(this.sdkReadyPromise=new Promise(function(t,r){e.once(l.ON_SDK_READY,function(){t()})}),this.sdkReadyPromise):Promise.resolve()}},{key:"waitAppIDCacheBuild",value:function(){var e=lr.getInstance();if(e.isInited())return Promise.resolve();if(this._actualWeChatAppID)return e.build({wechatAppID:this._actualWeChatAppID});if(!this.appIDReadyPromise){var t=this.shareManager.getShareController();if(!t)return Promise.resolve();this.appIDReadyPromise=new Promise(function(r,n){t.once(l.ON_SDK_READY,function(t){var n=t.wechatAppID,a=t.magicTrace;Promise.all([e.build({wechatAppID:n}),Se.getInstance().build({magicTrace:a})]).then(function(){r()})})})}return this.appIDReadyPromise}},{key:"share",value:function(e,t){var r=this;return this._hasInited?t?this.prepareShareSafe(t,e).then(function(){return r.shareManager.share(e)}):this.shareManager.share(e):Promise.reject()}},{key:"_buildThumbnailURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=e.thumbnailURL;if(void 0!==r){var n=e.waterMark,a=r||"";void 0!==n&&null!==n||(n=Rr.DEFAULT),a=br(a,n),t===c.WECHAT_SESSION&&n===Rr.DEFAULT&&(a=br(a,Rr.WE_CHAT_MSG,!0)),a=(a||"").replace(/^\/\//,"http://"),e.thumbnailURL=a}}},{key:"_buildShareURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],e.shareURL);if(r){if(e.urlWrapType!==j.RAW){var n=new w(r),a=n.query||{},i=Object.keys(a).reduce(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Dr.indexOf(t)>=0&&(e[t]=null),e},{}),o=Object(Y.b)(!0),s={_wv:41729,_wvx:10};!Object(p.a)().isWeChatPlatform||t!==c.QQ_CHAT_SESSION&&t!==c.QQ_ZONE||(s.sf_tag="wechat"),t!==c.WECHAT_TIMELINE_IMAGE&&t!==c.WECHAT_TIMELINE_IMAGE_WITH_NO_SDK||(s.from="qrImg");var h=n.pathname||"";e.addRandomPrefix&&(h=h.replace(/(\w+)\.html/g,function(e){return Math.floor(1e3*Math.random())+""+e}));var l=Object.assign({},s,a,o,Lr,i),_=e.shareDomain||Nr.shareDomain;e.shareURL=U(l,Object(u.h)(h),_)}}else delete e.shareURL}},{key:"_checkSDKPrepared",value:function(e){var t=e.flowControllConfig,r=void 0===t?{}:t,n=e.otherConfig,i=void 0===n?{}:n;if(r.isSDKPrepare&&!this._sdkPrepared){this._sdkPrepared=!0;var o=this.shareManager.getShareController();i.wechatAppID&&(this._actualWeChatAppID=i.wechatAppID);var s=i.shareTypeEnable;if(s&&"object"===a()(s)){var h=Object.keys(s).filter(function(e){return!s[e]}).map(function(e){return parseInt(e,10)});o.disableShare(h)}o&&o.emit(l.ON_SDK_READY,{wechatAppID:i.wechatAppID,magicTrace:i.magicTrace})}}},{key:"getShareManager",value:function(){return this.shareManager?this.shareManager:null}},{key:"setupNativeShareButton",value:function(e,t){if(this.shareManager)return this.shareManager.setupNativeShareButton(e,t)}}]),e}();Pr.getInstance=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Mr||(Mr=new Pr(e)),Mr};var Hr=Pr,wr={ALIGNMENT_CENTER:"alignment_center",BOLD_FONT:"bold_font",CORRECTION_LEVEL:"correction_level",DATA:"data",FILL:"fill",FONT_SIZE:"font_size",FONT_COLOR:"font_color",HEIGHT:"height",POS_X:"x",POS_Y:"y",SOURCE:"source",WIDTH:"width",KEY:"key"};var Ur=Object.keys(wr).reduce(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return e[wr[t]]=1,e},{}),kr=function(){function e(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;o()(this,e),this.attributes={},this.setBounds(t,r,n,a),this.setData(i)}return h()(e,[{key:"setAttr",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;Ur[e]&&(this.attributes[e]=t)}},{key:"setLocation",value:function(e,t){void 0!==e&&void 0!==t&&(this.setAttr(wr.POS_X,e),this.setAttr(wr.POS_Y,t))}},{key:"setSize",value:function(e,t){void 0!==e&&void 0!==t&&(this.setAttr(wr.WIDTH,e),this.setAttr(wr.HEIGHT,t))}},{key:"setData",value:function(e){void 0!==e&&this.setAttr(wr.DATA,e)}},{key:"setBounds",value:function(e,t,r,n){this.setLocation(e,t),this.setSize(r,n)}},{key:"setKey",value:function(e){this.setAttr(wr.KEY,e)}},{key:"getAttrs",value:function(){return this.attributes}}]),e}();kr.SOURCE_TYPE={RECTANGLE:"rectangle",IMAGE:"image",TEXT:"text",QRCODE:"qrcode"},kr.ATTRIBUTES=wr,kr.ATTRIBUTES_VALUES=Ur,kr.color=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return parseInt(e.slice(1),16)},kr.CorrectionLevel={M:0,L:1,Q:3,H:2};var Wr=kr,xr=Wr.ATTRIBUTES,jr=Wr.SOURCE_TYPE,Br=function(e){function t(){var e;return o()(this,t),(e=A()(this,d()(t).apply(this,arguments))).setAttr(xr.SOURCE,jr.IMAGE),e}return m()(t,e),t}(Wr),Gr=Wr.ATTRIBUTES,Fr=Wr.SOURCE_TYPE,Qr=Wr.CorrectionLevel,Yr=Object.keys(Qr).map(function(e){return Qr[e]}),Kr=function(e){function t(){var e;return o()(this,t),(e=A()(this,d()(t).apply(this,arguments))).setAttr(Gr.SOURCE,Fr.QRCODE),e}return m()(t,e),h()(t,[{key:"setCorrectionLevel",value:function(e){Yr.indexOf(e)<0||this.setAttr(Gr.CORRECTION_LEVEL,e)}}]),t}(Wr);Kr.CorrectionLevel=Qr;var Xr=Kr,qr=Wr.ATTRIBUTES,Vr=Wr.SOURCE_TYPE,Zr=function(e){function t(){var e;return o()(this,t),(e=A()(this,d()(t).apply(this,arguments))).setAttr(qr.SOURCE,Vr.TEXT),e}return m()(t,e),h()(t,[{key:"setFontSize",value:function(e){e&&this.setAttr(qr.FONT_SIZE,e)}},{key:"setRemFontSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.setFontSize(45*e)}},{key:"setColor",value:function(e){var t=qr.FONT_COLOR;"number"==typeof e?this.setAttr(t,e):"string"==typeof e&&this.setAttr(t,Wr.color(e))}},{key:"setAlignCenter",value:function(){this.setAttr(qr.ALIGNMENT_CENTER,!0)}},{key:"setBold",value:function(){this.setAttr(qr.BOLD_FONT,!0)}}]),t}(Wr),zr=Wr.ATTRIBUTES,Jr=Wr.SOURCE_TYPE,$r={PaintImage:Br,QRCode:Xr,Rectangle:function(e){function t(){var e;return o()(this,t),(e=A()(this,d()(t).apply(this,arguments))).setAttr(zr.SOURCE,Jr.RECTANGLE),e}return m()(t,e),h()(t,[{key:"setFill",value:function(e){this.setAttr(zr.FILL,e)}}]),t}(Wr),Text:Zr},en={POST_TO_FACEBOOK:1,POST_TO_TWITTER:2,POST_TO_WEIBO:3,MESSAGE:4,MAIL:5,PRINT:6,COPY_TO_PASTEBOARD:7,ASSIGN_TO_CONTACT:8,SAVE_TO_CAMERA_ROLL:9,ADD_TO_READING_LIST:10,POST_TO_FLICKR:11,POST_TO_VIMEO:12,POST_TO_TENCENT_WEIBO:13,AIR_DROP:14};r.d(t,"ShareErrorCode",function(){return tn}),r.d(t,"paintElems",function(){return $r}),r.d(t,"ShareChannel",function(){return nr}),r.d(t,"ShareEventType",function(){return l}),r.d(t,"ShareImage",function(){return it}),r.d(t,"ShareResult",function(){return Vt}),r.d(t,"ShareResultType",function(){return tt}),r.d(t,"ShareType",function(){return c}),r.d(t,"ShareWaterMark",function(){return Rr}),r.d(t,"URLWrapType",function(){return j}),r.d(t,"ShareForm",function(){return F}),r.d(t,"ShareMethod",function(){return Q}),r.d(t,"IOSSystemShareChoice",function(){return en}),r.d(t,"ThirdPartyOpenType",function(){return Et}),r.d(t,"WxAppShareMode",function(){return Ut}),r.d(t,"CipherConsumeMode",function(){return xe}),r.d(t,"TPSelectCategory",function(){return Ye});var tn=D.ShareErrorCode,rn={};rn=Hr;t.default=rn}}]);